$NetBSD: patch-at,v 1.1.2.2 2005/12/15 08:54:51 seb Exp $

Security fix for CVE-2005-3694, from Debian.

--- libicq2000-0.1/src/DirectClient.cpp.orig	2004-02-11 00:51:14.000000000 +0100
+++ libicq2000-0.1/src/DirectClient.cpp	2005-12-11 16:40:06.000000000 +0100
@@ -162,6 +162,7 @@
 
       m_recv.setLittleEndian();
       m_recv >> length;
+      if (length == 0) return; // short read, toss it back (nothing to do)
       if (length > Incoming_Packet_Limit) throw ParseException("Received too long incoming packet");
       if (m_recv.remains() < length) return; // waiting for more of the packet
 
