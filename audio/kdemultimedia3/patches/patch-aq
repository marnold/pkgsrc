$NetBSD: patch-aq,v 1.1.1.1.2.2 2002/06/23 18:38:11 jlam Exp $

--- kscd/libwm/plat_freebsd.c.orig	Fri Jan 11 03:19:57 2002
+++ kscd/libwm/plat_freebsd.c
@@ -34,3 +34,3 @@
 
-#if defined(__FreeBSD__) || defined(__FreeBSD) || defined(__NetBSD__) || defined (__NetBSD)
+#if defined(__FreeBSD__) || defined(__FreeBSD) || defined(__NetBSD__)
 
@@ -52,3 +52,3 @@
 
-#if defined(__NetBSD__) || defined(__OpenBSD__) 
+#if defined(__OpenBSD__) 
 # define MSF_MINUTES 1
@@ -59,2 +59,5 @@
 # include "/sys/scsi/scsi_cd.h"
+#elif defined(__NetBSD__)
+#include <sys/scsiio.h>
+#include <dev/scsipi/scsipi_cd.h>
 #else
@@ -235,7 +238,2 @@
     dopos:
-#ifdef __NetBSD__
-      *pos = scd.what.position.absaddr[MSF_MINUTES] * 60 * 75 +
-	scd.what.position.absaddr[MSF_SECONDS] * 75 +
-	scd.what.position.absaddr[MSF_FRAMES];
-#else
       *pos = scd.what.position.absaddr.msf.minute * 60 * 75 +
@@ -243,3 +241,2 @@
 	scd.what.position.absaddr.msf.frame;
-#endif
       *track = scd.what.position.track_number;
@@ -310,7 +307,2 @@
   
-#ifdef __NetBSD__
-  *startframe = toc_buffer.addr[MSF_MINUTES]*60*75 +
-    toc_buffer.addr[MSF_SECONDS] * 75 +
-    toc_buffer.addr[MSF_FRAMES];
-#else
   *startframe = toc_buffer.addr.msf.minute*60*75 +
@@ -318,3 +310,2 @@
     toc_buffer.addr.msf.frame;
-#endif
   
