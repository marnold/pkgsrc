$NetBSD: patch-aa,v 1.5.2.2 2009/12/03 10:16:10 tron Exp $

SVN r16957

--- lib/codebook.c.orig	2009-07-09 09:12:08.000000000 +0000
+++ lib/codebook.c
@@ -198,6 +198,7 @@ int vorbis_staticbook_unpack(oggpack_buf
       for(i=0;i<s->entries;){
         long num=oggpack_read(opb,_ilog(s->entries-i));
         if(num==-1)goto _eofout;
+	if(length>32)goto _errout;
         for(j=0;j<num && i<s->entries;j++,i++)
           s->lengthlist[i]=length;
         length++;
