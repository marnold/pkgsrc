$NetBSD: patch-ae,v 1.1.1.1 2001/03/14 16:14:08 skrll Exp $

--- kmidi/linux_a.cpp.orig	Mon Jan 22 12:14:45 2001
+++ kmidi/linux_a.cpp
@@ -36,6 +36,13 @@
 #include <linux/soundcard.h>
 #endif
 
+#ifdef __NetBSD__
+#include <stdio.h>
+#include <sys/ioctl.h>
+#include <soundcard.h>
+#endif
+
+
 #ifdef __FreeBSD__
 #include <stdio.h>
 #include <machine/soundcard.h>
@@ -320,13 +327,21 @@
 static void flush_output(void)
 {
   output_data(0, 0);
+#if defined(__NetBSD__)
+  ioctl(dpm.fd, SNDCTL_DSP_SYNC, NULL);
+#else
   ioctl(dpm.fd, SNDCTL_DSP_SYNC);
+#endif
 }
 
 static void purge_output(void)
 {
   b_out(dpm.id_character, dpm.fd, 0, -1);
+#if defined(__NetBSD__)
+  ioctl(dpm.fd, SNDCTL_DSP_RESET, NULL);
+#else
   ioctl(dpm.fd, SNDCTL_DSP_RESET);
+#endif
 }
 
 #endif /* defined(__linux__) || defined(__FreeBSD__) || defined(__bsdi__) */
