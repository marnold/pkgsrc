$NetBSD: patch-aa,v 1.3.2.1 2006/02/26 22:01:11 seb Exp $

--- src/Makefile.shlib.orig	2003-10-19 21:34:33.000000000 -0400
+++ src/Makefile.shlib
@@ -66,7 +66,7 @@ LINK.static = $(AR) $(AROPT)
 ifeq ($(enable_shared), yes)
 
 # Insert -L from LDFLAGS after any -L already present in SHLIB_LINK
-SHLIB_LINK := $(filter -L%, $(SHLIB_LINK)) $(filter -L%, $(LDFLAGS)) $(filter-out -L%, $(SHLIB_LINK))
+SHLIB_LINK := $(LDFLAGS) $(SHLIB_LINK)
 
 # Need a -L-free version of LDFLAGS to use in combination with SHLIB_LINK
 LDFLAGS_NO_L := $(filter-out -L%, $(LDFLAGS))
@@ -114,7 +114,7 @@ endif
 
 ifeq ($(PORTNAME), freebsd)
   ifdef ELF_SYSTEM
-    shlib		:= lib$(NAME)$(DLSUFFIX).$(SO_MAJOR_VERSION)
+    shlib		:= lib$(NAME)$(DLSUFFIX).$(SO_MAJOR_VERSION).$(SO_MINOR_VERSION)
     LINK.shared		= $(COMPILER) -shared -Wl,-x,-soname,$(soname)
   else
     shlib		:= lib$(NAME)$(DLSUFFIX).$(SO_MAJOR_VERSION).$(SO_MINOR_VERSION)
@@ -131,8 +131,13 @@ ifeq ($(PORTNAME), netbsd)
   endif
 endif
 
+ifeq ($(PORTNAME), dragonfly)
+  shlib			:= lib$(NAME)$(DLSUFFIX).$(SO_MAJOR_VERSION).$(SO_MINOR_VERSION)
+  LINK.shared		= $(COMPILER) -shared -Wl,-x,-soname,$(soname)
+endif
+
 ifeq ($(PORTNAME), hpux)
-  shlib			:= lib$(NAME)$(DLSUFFIX).$(SO_MAJOR_VERSION)
+  shlib			:= lib$(NAME)$(DLSUFFIX).$(SO_MAJOR_VERSION).$(SO_MINOR_VERSION)
   LINK.shared		= $(LD) +h $(soname) -b +b $(libdir)
   ifeq ($(GCC), yes)
     SHLIB_LINK		+= `$(CC) -print-libgcc-file-name`
@@ -140,7 +145,7 @@ ifeq ($(PORTNAME), hpux)
 endif
 
 ifeq ($(PORTNAME), irix5)
-  shlib			:= lib$(NAME)$(DLSUFFIX).$(SO_MAJOR_VERSION)
+  shlib			:= lib$(NAME)$(DLSUFFIX).$(SO_MAJOR_VERSION).$(SO_MINOR_VERSION)
   LINK.shared		= $(COMPILER) -shared -Wl,-set_version,sgi$(SO_MAJOR_VERSION).$(SO_MINOR_VERSION)
 endif
 
