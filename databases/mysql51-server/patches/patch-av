$NetBSD: patch-av,v 1.1.2.2 2010/04/21 06:30:05 spz Exp $

Security fix for http://secunia.com/advisories/39454/.

--- sql/sql_plugin.cc.orig	2010-03-01 19:33:41.000000000 +0000
+++ sql/sql_plugin.cc
@@ -1736,6 +1736,8 @@ bool mysql_uninstall_plugin(THD *thd, co
   bzero(&tables, sizeof(tables));
   tables.db= (char *)"mysql";
   tables.table_name= tables.alias= (char *)"plugin";
+  if (check_table_access(thd, DELETE_ACL, &tables, 1, FALSE))
+    DBUG_RETURN(TRUE);
 
   /* need to open before acquiring LOCK_plugin or it will deadlock */
   if (! (table= open_ltable(thd, &tables, TL_WRITE, 0)))
