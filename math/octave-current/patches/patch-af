$NetBSD: patch-af,v 1.1.1.1 2001/03/27 12:06:55 wennmach Exp $

--- liboctave/Makefile.in.orig	Tue Jul 18 07:33:02 2000
+++ liboctave/Makefile.in	Sat Dec 30 10:13:43 2000
@@ -18,7 +18,7 @@
 INSTALL_PROGRAM = @INSTALL_PROGRAM@
 INSTALL_DATA = @INSTALL_DATA@
 
-LIBOCTAVE_LFLAGS = -L../libcruft -L../readline -L../kpathsea \
+LIBOCTAVE_LFLAGS = -L../libcruft -L${LOCALBASE}/lib -L../kpathsea \
 	-L../glob -L. $(RLD_FLAG)
 
 LIBOCTAVE_LIBS = -lcruft -lreadline -lkpathsea -lglob
@@ -146,25 +146,11 @@
 	  mkdir pic; \
 	fi
 
-ifeq ($(SHARED_LIBS), true)
-  ifeq ($(STATIC_LIBS), true)
-    libraries: liboctave.$(LIBEXT) liboctave.$(SHLEXT)
-  else
-    libraries: liboctave.$(SHLEXT)
-  endif
-else
-  ifeq ($(STATIC_LIBS), true)
-    libraries: liboctave.$(LIBEXT)
-  else
-    libraries:
-  endif
-endif
+libraries: liboctave.$(LIBEXT)
 .PHONY: libraries
 
 liboctave.$(LIBEXT): $(OBJECTS)
-	rm -f $@
-	$(AR) $(ARFLAGS) $@ $^
-	$(RANLIB) $@
+	${LIBTOOL} --mode=link cc -o liboctave.${LIBEXT} ${OBJECTS:.o=.lo} -rpath ${PREFIX}/lib -version-info ${version:2.1.%=2:%}
 
 liboctave.$(SHLEXT): liboctave.$(SHLEXT_VER)
 	rm -f $@
@@ -188,20 +174,7 @@
 
 install-lib:
 	$(top_srcdir)/mkinstalldirs $(octlibdir)
-	if $(STATIC_LIBS); then \
-	  rm -f $(octlibdir)/liboctave.$(LIBEXT); \
-	  $(INSTALL_DATA) liboctave.$(LIBEXT) \
-	    $(octlibdir)/liboctave.$(LIBEXT); \
-	  $(RANLIB) $(octlibdir)/liboctave.$(LIBEXT); \
-	fi
-	if $(SHARED_LIBS); then \
-	  rm -f $(octlibdir)/liboctave.$(SHLEXT_VER); \
-	  $(INSTALL_PROGRAM) \
-	    liboctave.$(SHLEXT_VER) $(octlibdir)/liboctave.$(SHLEXT_VER); \
-	  cd $(octlibdir); \
-	  rm -f liboctave.$(SHLEXT); \
-	  $(LN_S) liboctave.$(SHLEXT_VER) liboctave.$(SHLEXT); \
-	fi
+	${LIBTOOL} --mode=install ${BSD_INSTALL_DATA} liboctave.${LIBEXT} ${PREFIX}/lib
 	$(mk-libdir-link)
 .PHONY: install-lib
 
