$NetBSD: patch-ak,v 1.1.10.1 2006/02/15 14:12:20 salo Exp $

--- ext/imap/php_imap.c.orig	2006-01-05 02:47:16.000000000 +0200
+++ ext/imap/php_imap.c	2006-02-05 15:37:19.000000000 +0200
@@ -429,6 +429,11 @@
 
 	ZEND_INIT_MODULE_GLOBALS(imap, php_imap_init_globals, NULL)
 
+/*
+ * Optionally use the installed c-client linkage.c to determine which drivers
+ * are authenticators are linked in. Otherwise use this fixed list.
+ */
+#ifndef HAVE_IMAP_LINKAGE
 #ifndef PHP_WIN32
 	mail_link(&unixdriver);		/* link in the unix driver */
 	mail_link(&mhdriver);		/* link in the mh driver */
@@ -444,6 +449,10 @@
 	mail_link(&tenexdriver);	/* link in the tenex driver */
 	mail_link(&mtxdriver);		/* link in the mtx driver */
 	mail_link(&dummydriver);	/* link in the dummy driver */
+#else /* HAVE_IMAP_LINKAGE */
+        /* link in the c-client mail and auth drivers */
+#include "linkage.c"
+#endif /* HAVE_IMAP_LINKAGE */
 
 #ifndef PHP_WIN32
 	auth_link(&auth_log);		/* link in the log authenticator */
