$NetBSD: patch-ag,v 1.1.1.1 2001/06/30 08:25:48 taca Exp $

--- ruby.c.orig	Mon Jul 31 18:20:15 2000
+++ ruby.c
@@ -345,9 +345,8 @@
 	    }
 	    if (!e_fp) {
 		int fd;
-		e_tmpname = ruby_mktemp();
-		if (!e_tmpname) rb_fatal("Can't mktemp");
-		fd = open(e_tmpname, O_CREAT|O_EXCL|O_RDWR, 0600);
+		e_tmpname = ruby_mktemp(&fd);
+		if (!e_tmpname) rb_fatal("Can't alloc memory");
 		if (fd < 0) {
 		    rb_fatal("Cannot open temporary file: %s", e_tmpname);
 		}
