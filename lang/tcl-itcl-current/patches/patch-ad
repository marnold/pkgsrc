$NetBSD: patch-ad,v 1.1.1.1 2004/09/24 21:16:02 dmcmahill Exp $

--- itk/Makefile.in.orig	Tue Aug 17 17:47:18 2004
+++ itk/Makefile.in
@@ -96,19 +96,19 @@ DESTDIR		=
 
 PKG_DIR		= $(PACKAGE_NAME)$(PACKAGE_VERSION)
 pkgdatadir	= $(datadir)/$(PKG_DIR)
-pkglibdir	= $(libdir)/$(PKG_DIR)
+pkglibdir	= $(libdir)/tcl/$(PKG_DIR)
 pkgincludedir	= $(includedir)/$(PKG_DIR)
 
 top_builddir	= .
 
-INSTALL		= @INSTALL@
-INSTALL_PROGRAM	= @INSTALL_PROGRAM@
-INSTALL_DATA	= @INSTALL_DATA@
-INSTALL_SCRIPT	= @INSTALL_SCRIPT@
+INSTALL = ${LIBTOOL} --mode=install ${BSD_INSTALL}
+INSTALL_PROGRAM = ${LIBTOOL} --mode=install ${BSD_INSTALL_PROGRAM}
+INSTALL_DATA = ${LIBTOOL} --mode=install ${BSD_INSTALL_DATA}
+INSTALL_SCRIPT = ${LIBTOOL} --mode=install ${BSD_INSTALL_SCRIPT}
 
 PACKAGE_NAME	= @PACKAGE_NAME@
 PACKAGE_VERSION	= @PACKAGE_VERSION@
-CC		= @CC@
+CC		= ${LIBTOOL} --mode=compile @CC@
 CFLAGS_DEFAULT	= @CFLAGS_DEFAULT@
 CFLAGS_WARNING	= @CFLAGS_WARNING@
 CLEANFILES	= @CLEANFILES@
@@ -122,9 +122,9 @@ OBJEXT		= @OBJEXT@
 RANLIB		= @RANLIB@
 RANLIB_STUB	= @RANLIB_STUB@
 SHLIB_CFLAGS	= @SHLIB_CFLAGS@
-SHLIB_LD	= @SHLIB_LD@
+SHLIB_LD	= ${LIBTOOL} --mode=link @CC@ -rpath ${PREFIX}/lib
 SHLIB_LD_FLAGS	= @SHLIB_LD_FLAGS@
-SHLIB_LD_LIBS	= @SHLIB_LD_LIBS@
+SHLIB_LD_LIBS = -Wl,-R${X11BASE}/lib -L${X11BASE}/lib -Wl,-R${PREFIX}/lib -L${PREFIX}/lib -ltk84 -ltcl84 -lX11 -lm
 STLIB_LD	= @STLIB_LD@
 TCL_DEFS	= @TCL_DEFS@
 TCL_BIN_DIR	= @TCL_BIN_DIR@
@@ -256,12 +256,10 @@ depend:
 $(PKG_LIB_FILE): $(PKG_OBJECTS)
 	-rm -f $(PKG_LIB_FILE)
 	${MAKE_LIB}
-	$(RANLIB) $(PKG_LIB_FILE)
 
 $(PKG_STUB_LIB_FILE): $(PKG_STUB_OBJECTS)
 	-rm -f $(PKG_STUB_LIB_FILE)
 	${MAKE_STUB_LIB}
-	$(RANLIB_STUB) $(PKG_STUB_LIB_FILE)
 
 #========================================================================
 # We need to enumerate the list of .c to .o lines here.
@@ -317,7 +315,7 @@ distclean: clean
 
 install-lib-binaries:
 	@mkdir -p $(DESTDIR)$(pkglibdir)
-	@list='$(lib_BINARIES)'; for p in $$list; do \
+	@list='${PKG_LIB_FILE:C/\.so.*/.la/} ${PKG_STUB_LIB_FILE:C/\.so.*/.la/} $(lib_BINARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    echo " $(INSTALL_PROGRAM) $$p $(DESTDIR)$(pkglibdir)/$$p"; \
 	    $(INSTALL_PROGRAM) $$p $(DESTDIR)$(pkglibdir)/$$p; \
