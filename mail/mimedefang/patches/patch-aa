$NetBSD: patch-aa,v 1.1.1.1 2002/09/23 13:08:52 markd Exp $

--- rm_r.c~	Sat Sep  7 01:43:35 2002
+++ rm_r.c	Mon Sep 23 16:57:39 2002
@@ -24,6 +24,27 @@
 #include <syslog.h>
 #include <string.h>
 
+#ifdef __NetBSD__
+/*
+ * Fake an readdir_r until such time as NetBSD has one
+ * think this should be good enough for the nonpreemptive thread packages
+ */
+int
+readdir_r(DIR *dirp, struct dirent *entry, struct dirent **result)
+{
+    struct dirent *tmp_dirp;
+
+    tmp_dirp = readdir(dirp);
+    if (!tmp_dirp) {
+        *result = NULL;
+	return -1;
+    }
+    memcpy (entry, tmp_dirp, sizeof(struct dirent));
+    *result = entry;
+    return 0;
+}
+#endif
+
 /**********************************************************************
 * %FUNCTION: rm_r
 * %ARGUMENTS:
