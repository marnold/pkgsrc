$NetBSD: patch-as,v 1.1.1.1 2000/02/13 00:14:49 tron Exp $

--- src/Makefile.orig	Fri Mar 28 18:06:01 1997
+++ src/Makefile	Sat Feb 12 23:28:27 2000
@@ -5,6 +5,8 @@
 #  the "makesendmail" script.						#
 #########################################################################
 
+.include <bsd.own.mk>
+
 PROG=	sendmail
 
 # define the database format to use for aliases et al.  Can be -DNEWDB (for
@@ -15,33 +17,32 @@
 # databases are read, but the new format will be used on any rebuilds.  On
 # really gnarly systems, you can set this to null; it will crawl like a high
 # spiral snail, but it will work.
-DBMDEF=	-DNEWDB
+DBMDEF=	-DNEWDB -DNIS
 
-CFLAGS+=-I${.CURDIR} ${DBMDEF} -DNETISO
+CPPFLAGS+=-I${.CURDIR} ${DBMDEF} -DNETISO -DTCPWRAPPERS
+LDADD+=-lwrap
+DPADD+=${LIBWRAP}
 
 SRCS=	alias.c arpadate.c clock.c collect.c conf.c convtime.c daemon.c \
 	deliver.c domain.c envelope.c err.c headers.c macro.c main.c map.c \
 	mci.c mime.c parseaddr.c queue.c readcf.c recipient.c safefile.c \
 	savemail.c srvrsmtp.c stab.c stats.c sysexits.c trace.c udb.c \
 	usersmtp.c util.c version.c
-DPADD=	
-LDADD=	
-MAN1=	mailq.0 newaliases.0
-MAN5=	aliases.0
-MAN8=	sendmail.0 
-LINKS=	/usr/sbin/sendmail /usr/bin/newaliases \
-	/usr/sbin/sendmail /usr/bin/mailq
-BINDIR=	/usr/sbin
+MAN=	aliases.5 mailq.1 newaliases.1 sendmail.8
+# symlinks are now made by the mailwrapper make file
+#SYMLINKS=	/usr/sbin/sendmail /usr/bin/newaliases \
+#		/usr/sbin/sendmail /usr/bin/mailq
+BINDIR=	${PREFIX}/libexec/sendmail
 BINOWN=	root
 BINGRP=	kmem
 BINMODE=6555
+.if ${MKSHARE} != "no"
+FILES=sendmail.hf
+FILESDIR=${PREFIX}/share/misc
+.endif
 
-beforeinstall:
-#	install -c -o ${BINOWN} -g ${BINGRP} -m 644 /dev/null \
-#	    ${DESTDIR}/etc/sendmail.fc
-	install -c -o ${BINOWN} -g ${BINGRP} -m 644 /dev/null \
+afterinstall:
+	${INSTALL} ${INSTPRIV} -c -o ${BINOWN} -g ${BINGRP} -m 644 /dev/null \
 	    ${DESTDIR}/var/log/sendmail.st
-	install -c -o ${BINOWN} -g ${BINGRP} -m 444 ${.CURDIR}/sendmail.hf \
-	    ${DESTDIR}/usr/share/misc
 
 .include <bsd.prog.mk>
