$NetBSD: patch-aa,v 1.1.1.1 2001/10/16 06:23:08 jlam Exp $

--- config.m4.orig	Fri Jun  1 02:42:55 2001
+++ config.m4
@@ -36,7 +36,8 @@
   for i in $PHP_EXPAT_DIR $SABLOT_DIR; do
     if test -f $i/lib/libexpat.a -o -f $i/lib/libexpat.s?; then
       AC_DEFINE(HAVE_LIBEXPAT2,1,[ ])
-      PHP_ADD_LIBRARY_WITH_PATH(expat, $i/lib)
+      PHP_ADD_LIBRARY_WITH_PATH(expat, $i/lib, SABLOT_SHARED_LIBADD)
+      PHP_ADD_LIBRARY_WITH_PATH(m, /usr/lib, SABLOT_SHARED_LIBADD)
       PHP_ADD_INCLUDE($i/include)
       AC_CHECK_LIB(sablot, SablotSetEncoding, AC_DEFINE(HAVE_SABLOT_SET_ENCODING,1,[ ]))
       testval=yes
@@ -51,14 +52,12 @@
   found_iconv=no
   AC_CHECK_LIB(c, iconv_open, found_iconv=yes)
   if test "$found_iconv" = "no"; then
-    if test "$PHP_ICONV" = "no"; then
-      for i in /usr /usr/local; do
+      for i in $PHP_ICONV /usr /usr/local; do
         if test -f $i/lib/libconv.a -o -f $i/lib/libiconv.s?; then
-          PHP_ADD_LIBRARY_WITH_PATH(iconv, $i/lib)
+          PHP_ADD_LIBRARY_WITH_PATH(iconv, $i/lib, SABLOT_SHARED_LIBADD)
           found_iconv=yes
         fi
       done
-    fi
   fi
   
   if test "$found_iconv" = "no"; then
