$NetBSD: patch-az,v 1.1.4.1 2006/12/09 09:13:15 salo Exp $

--- src/input/input_http.c.orig	2006-11-30 10:54:18.000000000 +0000
+++ src/input/input_http.c
@@ -789,7 +789,8 @@ static int http_plugin_open (input_plugi
   while (!done) {
     /* fprintf (stderr, "input_http: read...\n"); */
 
-    if (_x_io_tcp_read (this->stream, this->fh, &this->buf[len], 1) <= 0) {
+    if (len == sizeof(this->buf) ||
+        _x_io_tcp_read (this->stream, this->fh, &this->buf[len], 1) <= 0) {
       return -5;
     }
 
