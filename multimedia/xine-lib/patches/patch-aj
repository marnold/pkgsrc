$NetBSD: patch-aj,v 1.4.2.1 2005/04/27 02:53:42 snj Exp $

--- src/input/mms.c	2005/01/18 23:25:34	1.55
+++ src/input/mms.c	2005/04/21 19:02:43	1.56
@@ -583,9 +583,13 @@
           lprintf ("stream object, stream id: %d, type: %d, encrypted: %d\n",
                    stream_id, type, encrypted);
           
-          this->stream_types[stream_id] = type;
-          this->stream_ids[this->num_stream_ids] = stream_id;
-          this->num_stream_ids++;
+          if (this->num_stream_ids < ASF_MAX_NUM_STREAMS && stream_id < ASF_MAX_NUM_STREAMS) {
+            this->stream_types[stream_id] = type;
+            this->stream_ids[this->num_stream_ids] = stream_id;
+            this->num_stream_ids++;
+          } else {
+            lprintf ("too many streams, skipping\n");
+          }
       
         }
         break;
