$NetBSD: patch-ab,v 1.1.1.1 2001/05/14 17:26:53 rh Exp $

--- src/gftp.c.orig	Tue May  1 15:19:17 2001
+++ src/gftp.c
@@ -80,6 +80,23 @@
 static int remote_start, local_start, tools_start;
 static GtkItemFactoryEntry *menus;
 
+#ifdef __NetBSD__
+#include <gtk/gtk.h>
+#include <pthread.h>
+
+/*
+ * NetBSD uses non-preemptive pth, so we yield the processor periodically
+ */
+
+gint
+pth_nbschedule (gpointer data)
+{
+	pthread_yield_np();
+
+	return TRUE;
+}
+#endif
+
 int
 main (int argc, char *argv[])
 {
@@ -138,6 +155,10 @@
   gftp_connect (window1.hdata->ftpdata);
   ftp_list_files (&window1, 0);
   update_ftp_info ();
+
+#ifdef __NetBSD__
+	gtk_timeout_add (200, pth_nbschedule, NULL);
+#endif
 
   gtk_main ();
   return (0);
