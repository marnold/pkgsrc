$NetBSD: patch-ef,v 1.1.2.2 2008/05/29 14:14:53 tron Exp $

--- utils/smbfilter.c.orig	2008-03-08 16:33:37.000000000 +0100
+++ utils/smbfilter.c
@@ -140,7 +140,7 @@ static void filter_child(int c, struct i
 		if (num <= 0) continue;
 		
 		if (c != -1 && FD_ISSET(c, &fds)) {
-			if (!receive_smb(c, packet, 0)) {
+			if (!receive_smb(c, packet, BUFFER_SIZE, 0)) {
 				d_printf("client closed connection\n");
 				exit(0);
 			}
@@ -151,7 +151,7 @@ static void filter_child(int c, struct i
 			}			
 		}
 		if (s != -1 && FD_ISSET(s, &fds)) {
-			if (!receive_smb(s, packet, 0)) {
+			if (!receive_smb(s, packet, BUFFER_SIZE, 0)) {
 				d_printf("server closed connection\n");
 				exit(0);
 			}
