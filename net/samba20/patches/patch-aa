$NetBSD: patch-aa,v 1.1.1.1 2001/08/03 13:24:37 jlam Exp $

--- Makefile.in.orig	Thu Mar 16 17:57:08 2000
+++ Makefile.in
@@ -14,6 +14,8 @@
 LDFLAGS=@LDFLAGS@
 AWK=@AWK@
 
+TERMLIBS=@TERMLIBS@
+
 INSTALLCMD=@INSTALL@
 
 VPATH=@srcdir@
@@ -23,12 +25,12 @@
 
 BASEDIR= @prefix@
 BINDIR = @bindir@
-# we don't use sbindir because we want full compatibility with
-# the previous releases of Samba
-SBINDIR = @bindir@
+SBINDIR = @sbindir@
 LIBDIR = @libdir@
 VARDIR = @localstatedir@
 MANDIR = @mandir@
+DATADIR = @datadir@
+CONFIGDIR?= $(BASEDIR)/etc
 SAMBABOOK = @sambabook@
 
 # The permissions to give the executables
@@ -39,10 +41,10 @@
 # or in smb.conf (see smb.conf(5))
 SMBLOGFILE = $(VARDIR)/log.smb
 NMBLOGFILE = $(VARDIR)/log.nmb
-CONFIGFILE = $(LIBDIR)/smb.conf
-LMHOSTSFILE = $(LIBDIR)/lmhosts
-DRIVERFILE = $(LIBDIR)/printers.def
-PASSWD_PROGRAM = /bin/passwd
+CONFIGFILE = $(CONFIGDIR)/smb.conf
+LMHOSTSFILE = $(CONFIGDIR)/lmhosts
+DRIVERFILE = $(CONFIGDIR)/printers.def
+PASSWD_PROGRAM = /usr/bin/passwd
 # This is where smbpasswd et al go
 PRIVATEDIR = @privatedir@
 
@@ -55,7 +57,7 @@
 LOCKDIR = @lockdir@
 
 # The directory where code page definition files go
-CODEPAGEDIR = $(LIBDIR)/codepages
+CODEPAGEDIR = $(DATADIR)/samba/codepages
 
 # The current codepage definition list.
 CODEPAGELIST= 437 737 775 850 852 861 932 866 949 950 936 1251 ISO8859-1 ISO8859-2 ISO8859-5 ISO8859-7 KOI8-R
@@ -377,7 +379,7 @@
 
 bin/smbclient: $(CLIENT_OBJ) bin/.dummy
 	@echo Linking $@
-	@$(CC) $(FLAGS) -o $@ $(CLIENT_OBJ) $(LDFLAGS) $(LIBS)
+	@$(CC) $(FLAGS) -o $@ $(CLIENT_OBJ) $(LDFLAGS) $(TERMLIBS) $(LIBS)
 
 bin/smbspool: $(CUPS_OBJ) bin/.dummy
 	@echo Linking $@
@@ -462,8 +464,9 @@
 install: installbin installman installscripts installcp installswat
 
 installdirs:
-	$(SHELL) $(srcdir)/install-sh -d -m $(INSTALLPERMS) \
-	$(BASEDIR) $(SBINDIR) $(BINDIR) $(LIBDIR) $(VARDIR) $(CODEPAGEDIR)
+	@for dir in $(BASEDIR) $(SBINDIR) $(BINDIR) $(LIBDIR) $(VARDIR) $(CODEPAGEDIR); do \
+		$(SHELL) $(srcdir)/install-sh -d -m $(INSTALLPERMS) $${dir}; \
+	done
 
 installservers: all installdirs
 	@$(SHELL) $(srcdir)/script/installbin.sh $(INSTALLPERMS) $(BASEDIR) $(SBINDIR) $(LIBDIR) $(VARDIR) $(SPROGS)
