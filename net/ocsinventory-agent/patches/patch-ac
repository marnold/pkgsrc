$NetBSD: patch-ac,v 1.1.1.1 2009/08/16 18:25:53 bouyer Exp $

--- Makefile.PL.orig	2009-03-22 20:18:44.000000000 +0100
+++ Makefile.PL	2009-08-16 17:56:58.000000000 +0200
@@ -1,21 +1,6 @@
 
 use inc::Module::Install;
 
-# Hack to be able to run a post install script
-sub MY::postamble
-{
-
-	my $re;
-
-	$re = '
-install :: all pure_install doc_install
-	$(NOECHO) $(NOOP)';
-
-	$re .= "\n\t[ ! -f run-postinst ] || $^X postinst.pl\n";
-
-    return $re;
-}
-
 use Config;
 
 name 'Ocsinventory-Agent';
@@ -34,7 +19,7 @@
 recommends 'Proc::PID::File' => undef;
 
 install_script  'ocsinventory-agent';
-
+installdirs 'vendor';
 
 # We want a release bundled with the needed dependency to be able to
 # prepare a standealone binay with PAR::Packer 
@@ -47,14 +32,6 @@
 
 
 
-if (defined ($ENV{PERL_AUTOINSTALL}) || defined ($ENV{PERL_AUTOINSTALL})) {
-    unlink 'run-postinst';  
-} else {
-    open POSTINST, '>run-postinst' or die $!;
-    close POSTINST;
-}
-
-
 if (!can_use('Compress::Zlib')) {
     print "Please install Compress::Zlib if you use an OCS server prior 1.02.\n"; 
 }
@@ -77,7 +54,7 @@
     $archname = $t[0];
 };
 if ($^O =~ /(linux|bsd)/i && (!$archname ||$archname =~ /(i[3456x]86|x86_64|amd64)/i)) {
-    foreach (qw/dmidecode lspci/) {
+    foreach (qw/dmidecode pcictl/) {
         if (!can_run($_)) {
             print "\n";
             print "[WARNING] $_ is needed if you want a complet inventory on x86 and AMD64/x86_64.\n";
