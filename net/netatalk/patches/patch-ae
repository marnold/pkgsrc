$NetBSD: patch-ae,v 1.1.1.1 1998/12/26 22:09:27 agc Exp $

--- libatalk/Makefile	1998/10/26 13:10:36	1.1
+++ libatalk/Makefile	1998/10/26 13:14:24
@@ -1,63 +1,15 @@
-ALL=	asp atp nbp adouble util compat
-LIBS=	asp/asplib atp/atplib nbp/nbplib adouble/adoublelib \
-	util/utillib compat/compatlib
-PLIBS=	asp/asplib_p atp/atplib_p nbp/nbplib_p adouble/adoublelib_p \
-	util/utillib_p compat/compatlib_p
-TAGSFILE=tags
-CC=cc
-INSTALL=install
+LIB=	atalk
 
-all:	libatalk.a
+.include "${.CURDIR}/asp/Makefile.inc"
+.include "${.CURDIR}/atp/Makefile.inc"
+.include "${.CURDIR}/nbp/Makefile.inc"
+.include "${.CURDIR}/adouble/Makefile.inc"
+.include "${.CURDIR}/util/Makefile.inc"
+.include "${.CURDIR}/compat/Makefile.inc"
 
-libatalk.a: ${LIBS}
-	rm -rf tmp
-	-mkdir tmp
-	for i in ${ALL}; do (cd tmp; ar x ../$$i/$${i}lib); done
-	(cd tmp; ar cr libatalk.a  *.o; ranlib libatalk.a)
-	mv tmp/libatalk.a libatalk.a
-	ranlib libatalk.a
-	rm -rf tmp tmp_p
-	-mkdir tmp_p
-	for i in ${ALL}; do (cd tmp_p; ar x ../$$i/$${i}lib_p); done
-	(cd tmp_p; ar cr libatalk_p.a  *.o; ranlib libatalk_p.a)
-	mv tmp_p/libatalk_p.a libatalk_p.a
-	ranlib libatalk_p.a
-	rm -rf tmp_p
+CPPFLAGS=	${DEFS} ${OPTOPTS} -I${.CURDIR}/../include
 
-${ALL}: FRC
-	cd $@; ${MAKE} ${MFLAGS} CC="${CC}" DEFS="${DEFS}" \
-	    OPTOPTS="${OPTOPTS}"
+SHLIB_MAJOR=	1
+SHLIB_MINOR=	0
 
-asp/asplib:	asp
-atp/atplib:	atp
-nbp/nbplib:	nbp
-adouble/adoublelib:	adouble
-util/utillib:	util
-compat/compatlib:	compat
-
-FRC:
-
-tags:
-	for i in ${ALL}; do \
-	    (cd $$i; ${MAKE} ${MFLAGS} DEFS="${DEFS}" \
-		TAGSFILE=../${TAGSFILE} tags); \
-	done
-
-install: all
-	-mkdir ${LIBDIR}
-	${INSTALL} -c libatalk.a ${LIBDIR}/libatalk.a
-	(cd ${LIBDIR}; ranlib ${LIBDIR}/libatalk.a)
-	${INSTALL} -c libatalk_p.a ${LIBDIR}/libatalk_p.a
-	(cd ${LIBDIR}; ranlib ${LIBDIR}/libatalk_p.a)
-
-clean:
-	for i in ${ALL}; \
-	    do (cd $$i; ${MAKE} ${MFLAGS} clean); \
-	done
-	rm -f *[Ee]rrs libatalk.a libatalk_p.a
-	rm -rf tmp tmp_p
-
-depend:
-	for i in ${ALL}; \
-	    do (cd $$i; ${MAKE} ${MFLAGS} DEFS=${DEFS} depend); \
-	done
+.include <bsd.lib.mk>
