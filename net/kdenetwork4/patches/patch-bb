$NetBSD: patch-bb,v 1.1.2.2 2010/05/17 06:35:07 tron Exp $

--- kget/transfer-plugins/metalink/metalinker.h.orig	2008-01-04 23:59:18.000000000 +0000
+++ kget/transfer-plugins/metalink/metalinker.h
@@ -1,6 +1,7 @@
 /* This file is part of the KDE project
 
    Copyright (C) 2007 Manolo Valdes <nolis71cu@gmail.com>
+   Copyright (C) 2010 Matthias Fuchs <mat69@gmx.net>
 
    This program is free software; you can redistribute it and/or
    modify it under the terms of the GNU General Public
@@ -18,6 +19,14 @@ class MlinkFileData
 {
     public:
         MlinkFileData() {}
+
+        /**
+         * Controlls if the name attribute is valid, i.e. it is not empty and
+         * does not contain any directory traversal directives or information
+         * In case of faulty fileNames the MlinkFile gets discarded
+         */
+        bool isValidNameAttribute() const;
+
         QString fileName;
         QString md5;
         QString sha256;
