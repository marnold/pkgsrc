$NetBSD: patch-ci,v 1.1.2.2 2002/08/25 21:20:57 jlam Exp $

diff -u1 ospf6d/ospf6_zebra.c /home/itojun/work/zebra/zebra/ospf6d/ospf6_zebra.c
--- ospf6d/ospf6_zebra.c	Sun Jul  7 17:12:48 2002
+++ /home/itojun/work/zebra/zebra/ospf6d/ospf6_zebra.c	Sat Aug  3 21:06:15 2002
@@ -435,6 +435,9 @@
 
-  if (type == REMOVE && nexthop_list->count == 0)
+  if (type == REMOVE && nexthop_list->count != 0)
+    type = ADD;
+  else if (type == REMOVE && nexthop_list->count == 0)
     {
-      if (! ospf6_route_end (&route))
-        ospf6_route_next (&route);
+      if (IS_OSPF6_DUMP_ZEBRA)
+        zlog_info ("ZEBRA:   all nexthop with the selected path has gone");
+
       if (! memcmp (&request->route, &route.route,
@@ -446,3 +449,3 @@
           if (IS_OSPF6_DUMP_ZEBRA)
-            zlog_info ("ZEBRA:   find alternative path to add");
+            zlog_info ("ZEBRA:   found alternative path to add");
 
@@ -478,2 +481,9 @@
             zlog_info ("ZEBRA:   can't find alternative path, remove");
+
+          if (IS_OSPF6_DUMP_ZEBRA)
+            {
+              zlog_info ("ZEBRA:   Debug: walk over the route ?");
+              ospf6_route_log_request ("Debug route", "***", &route);
+              ospf6_route_log_request ("Debug request", "***", request);
+            }
 
