$NetBSD: patch-ap,v 1.2.10.1 2008/05/11 09:42:59 ghen Exp $

--- lib/bind/inet/inet_network.c.orig	2005-04-27 07:00:54.000000000 +0200
+++ lib/bind/inet/inet_network.c
@@ -84,9 +84,9 @@ again:
 	}
 	if (!digit)
 		return (INADDR_NONE);
+	if (pp >= parts + 4 || val > 0xffU)
+		return (INADDR_NONE);
 	if (*cp == '.') {
-		if (pp >= parts + 4 || val > 0xffU)
-			return (INADDR_NONE);
 		*pp++ = val, cp++;
 		goto again;
 	}
