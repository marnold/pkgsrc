$NetBSD: patch-ab,v 1.5.2.2 2005/11/03 13:27:30 salo Exp $

Fixes security issue published at http://secunia.com/advisories/17370/.
Diff taken from http://www.gentoo.org/cgi-bin/viewcvs.cgi/*checkout*/net-analyzer/ethereal/files/ethereal-0.10.13-fix-irc-loop-DoS-CVE-2005-3313.diff?hideattic=1

--- epan/dissectors/packet-irc.c	2005/09/23 21:33:02	15985
+++ epan/dissectors/packet-irc.c	2005/10/24 02:35:43	16290
@@ -86,6 +86,17 @@
 			 * Find the end of the line.
 			 */
 			linelen = tvb_find_line_end(tvb, offset, -1, &next_offset, FALSE);
+			if (next_offset == offset) {
+				/*
+				 * XXX - we really want the "show data a
+				 * line at a time" loops in various
+				 * dissectors to do reassembly and to
+				 * throw an exception if there's no
+				 * line ending in the current packet
+				 * and we're not doing reassembly.
+				 */
+				break;
+			}
 
 			if (linelen != 0)
 			{
