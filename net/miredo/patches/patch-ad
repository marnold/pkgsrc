$NetBSD: patch-ad,v 1.1.2.1 2006/06/07 18:23:42 ghen Exp $

--- compat/barrier.c.orig	2006-05-01 12:57:31.000000000 +0000
+++ compat/barrier.c
@@ -30,7 +30,27 @@
  ***********************************************************************/
 
 #include <errno.h>
+
+#if defined(__DragonFly__)
+#define pthread_barrier_init sys_pthread_barrier_init
+#define pthread_barrier_destroy sys_pthread_barrier_destroy
+#define pthread_barrier_wait sys_pthread_barrier_wait
+#define pthread_barrier_t sys_pthread_barrier_t
+#define pthread_barrierattr_init sys_pthread_barrierattr_init
+#define pthread_barrierattr_destroy sys_pthread_barrierattr_destroy
+#define pthread_barrierattr_t sys_pthread_barrierattr_t
+#endif
 #include <pthread.h>
+#if defined(__DragonFly__)
+#undef pthread_barrier_init
+#undef pthread_barrier_destroy
+#undef pthread_barrier_wait
+#undef pthread_barrier_t
+#undef pthread_barrierattr_init
+#undef pthread_barrierattr_destroy
+#undef pthread_barrierattr_t
+#undef PTHREAD_BARRIER_SERIAL_THREAD
+#endif
 #include "barrier.h"
 
 extern int
