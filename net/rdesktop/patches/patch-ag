$NetBSD: patch-ag,v 1.1.2.2 2008/05/11 09:25:19 ghen Exp $

--- printercache.c.orig	2006-08-07 13:45:43.000000000 +0200
+++ printercache.c
@@ -245,8 +245,8 @@ printercache_process(STREAM s)
 
 			/* NOTE - 'driver' doesn't contain driver, it contains the new printer name */
 
-			rdp_in_unistr(s, printer, printer_length);
-			rdp_in_unistr(s, driver, driver_length);
+			rdp_in_unistr(s, printer, sizeof(printer), printer_length);
+			rdp_in_unistr(s, driver, sizeof(printer), driver_length);
 
 			printercache_rename_blob(printer, driver);
 			break;
@@ -254,7 +254,7 @@ printercache_process(STREAM s)
 		case 3:	/* delete item */
 			in_uint8(s, printer_unicode_length);
 			in_uint8s(s, 0x3);	/* padding */
-			printer_length = rdp_in_unistr(s, printer, printer_unicode_length);
+			printer_length = rdp_in_unistr(s, printer, sizeof(printer), printer_unicode_length);
 			printercache_unlink_blob(printer);
 			break;
 
@@ -264,7 +264,7 @@ printercache_process(STREAM s)
 
 			if (printer_unicode_length < 2 * 255)
 			{
-				rdp_in_unistr(s, printer, printer_unicode_length);
+				rdp_in_unistr(s, printer, sizeof(printer), printer_unicode_length);
 				printercache_save_blob(printer, s->p, blob_length);
 			}
 			break;
