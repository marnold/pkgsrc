$NetBSD: patch-af,v 1.1.2.2 2008/05/11 09:25:19 ghen Exp $

--- rdpdr.c.orig	2006-08-07 13:45:43.000000000 +0200
+++ rdpdr.c
@@ -415,7 +415,7 @@ rdpdr_process_irp(STREAM s)
 
 			if (length && (length / 2) < 256)
 			{
-				rdp_in_unistr(s, filename, length);
+				rdp_in_unistr(s, filename, sizeof(filename), length);
 				convert_to_unix_filename(filename);
 			}
 			else
@@ -608,7 +608,7 @@ rdpdr_process_irp(STREAM s)
 					in_uint8s(s, 0x17);
 					if (length && length < 2 * 255)
 					{
-						rdp_in_unistr(s, filename, length);
+						rdp_in_unistr(s, filename, sizeof(filename), length);
 						convert_to_unix_filename(filename);
 					}
 					else
