$NetBSD: patch-aa,v 1.10.2.1 2002/06/23 19:03:55 jlam Exp $
--- build.xml.orig	Fri Oct 26 09:59:03 2001
+++ build.xml	Fri Apr 19 13:38:31 2002
@@ -2,15 +2,15 @@
 
 
   <!-- ==================== Initialization properties ===================== -->
-  <property name="ant.home" value="../jakarta-ant"/>
-  <property name="debug" value="on"/>
+  <property name="ant.home" value="${pkgsrc.prefix}"/>
+  <property name="debug" value="off"/>
   <property name="j2ee.home" value="../../j2ee/build/unix"/>
-  <property name="jaxp" value="../jaxp-1.1/jaxp.jar" />
-  <property name="parser" value="../jaxp-1.1/crimson.jar" />
+  <property name="jaxp" value="${pkgsrc.prefix}/lib/java" />
+  <property name="parser" value="${pkgsrc.prefix}/lib/java/crimson.jar" />
   <property name="optimize" value="true" />
-  <property name="servlet.jar" value="../jakarta-servletapi/lib/servlet.jar"/>
+  <property name="servlet.jar" value="${pkgsrc.prefix}/lib/java/servlet.jar"/>
   <property name="tomcat.build" value="../build/tomcat"/>
-  <property name="tomcat.dist" value="../dist/tomcat"/>
+  <property name="tomcat.dist" value="${pkgsrc.prefix}/tomcat"/>
 
 
   <!-- ======================== Copy static files ========================= -->
@@ -31,14 +31,18 @@
 
     <!-- Copy executables and scripts -->
     <copy todir="${tomcat.build}/bin">
-      <fileset dir="${ant.home}/bin" includes="ant*"/>
-      <fileset dir="src/shell"/>
+      <!-- <fileset dir="${ant.home}/bin" includes="ant*"/> -->
+      <fileset dir="src/shell" excludes="*.bat"/>
     </copy>
 
     <!-- Copy configuation files -->
     <copy todir="${tomcat.build}/conf">
       <fileset dir="src/etc"/>
     </copy>
+    <move todir="${tomcat.build}/conf/">
+      <fileset dir="${tomcat.build}/conf/" includes="jni_server.xml,server.xml,tomcat.policy,tomcat-users.xml,web.xml,workers.properties"/>
+      <mapper type="glob" from="*" to="*.default"/>
+    </move>
     <copy tofile="${tomcat.build}/conf/build.xml"
             file="build.xml"/>
 
@@ -51,6 +55,7 @@
     <copy tofile="${tomcat.build}/KEYS" file="KEYS"/>
 
     <!-- Copy library JAR files -->
+    <!--
     <copy tofile="${tomcat.build}/lib/ant.jar"
             file="${ant.home}/lib/ant.jar"/>
     <copy tofile="${tomcat.build}/lib/servlet.jar"
@@ -59,6 +64,7 @@
             file="${jaxp}"/>
     <copy todir="${tomcat.build}/lib"
             file="${parser}"/>
+    -->
 
     <!-- Copy golden files for the tests webapp -->
     <copy todir="${tomcat.build}/lib/test/Golden">
@@ -67,9 +73,11 @@
 
     <!-- Fixups for line endings and executable permissions -->
     <fixcrlf srcdir="${tomcat.build}" includes="**/*.sh" cr="remove"/>
+    <!--
     <fixcrlf srcdir="${tomcat.build}" includes="**/*.bat" cr="add"/>
     <chmod perm="+x" file="${tomcat.build}/bin/ant"/>
     <chmod perm="+x" file="${tomcat.build}/bin/antRun"/>
+    -->
     <chmod perm="+x" file="${tomcat.build}/bin/jspc.sh"/>
     <chmod perm="+x" file="${tomcat.build}/bin/startup.sh"/>
     <chmod perm="+x" file="${tomcat.build}/bin/shutdown.sh"/>
@@ -84,9 +92,9 @@
 
     <!-- Determine availability of optional components -->
     <available property="jsse.present" 
-               classname="com.sun.net.ssl.internal.ssl.Provider" />
+               classname="NotFoundForPkgsrc" />
     <available property="jdk12.present"
-               classname="java.security.PrivilegedAction" />
+               classname="NotFoundForPkgsrc" />
 
     <!-- Compile the standard Tomcat components -->
     <javac srcdir="src/share" destdir="${tomcat.build}/classes"
@@ -96,6 +104,8 @@
            deprecation="off" >
            <exclude name="**/Jdk12Interceptor.java" 
                     unless="jdk12.present"/>
+           <exclude name="**/Jdk12Support.java"
+                    unless="jdk12.present"/>
            <exclude name="**/SetSecurityManager.java" 
                     unless="jdk12.present"/>
            <exclude name="**/EmbededTomcat.java" 
@@ -204,8 +214,10 @@
     </copy>
 
     <!-- Fixups for executable permissions -->
+    <!--
     <chmod perm="+x" file="${tomcat.dist}/bin/ant"/>
     <chmod perm="+x" file="${tomcat.dist}/bin/antRun"/>
+    -->
     <chmod perm="+x" file="${tomcat.dist}/bin/jspc.sh"/>
     <chmod perm="+x" file="${tomcat.dist}/bin/startup.sh"/>
     <chmod perm="+x" file="${tomcat.dist}/bin/shutdown.sh"/>
