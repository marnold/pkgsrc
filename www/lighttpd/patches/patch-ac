$NetBSD: patch-ac,v 1.4.2.1 2008/05/21 13:01:02 tron Exp $

From SVN: Fix potential DOS by clearing SSL error queue.

--- src/network_openssl.c.orig	2008-04-25 18:29:42.000000000 +0200
+++ src/network_openssl.c
@@ -85,6 +85,7 @@ int network_write_chunkqueue_openssl(ser
 			 *
 			 */
 
+			ERR_clear_error();
 			if ((r = SSL_write(ssl, offset, toSend)) <= 0) {
 				unsigned long err;
 
@@ -187,6 +188,7 @@ int network_write_chunkqueue_openssl(ser
 
 				close(ifd);
 
+				ERR_clear_error();
 				if ((r = SSL_write(ssl, s, toSend)) <= 0) {
 					unsigned long err;
 
