$NetBSD: patch-ag,v 1.1.1.1 1999/07/23 17:53:30 itojun Exp $

--- src/Configure.orig	Mon Apr 26 14:34:33 1999
+++ src/Configure	Mon Apr 26 15:10:13 1999
@@ -974,16 +974,15 @@
 	    LDFLAGS_SHLIB_EXPORT=""
 	    SHLIB_SUFFIX_DEPTH=2
 	    ;;
-	alpha-*-netbsd*|mips-*-netbsd*|powerpc-*-netbsd*)
-	    CFLAGS_SHLIB="-fpic -DPIC"
-	    LDFLAGS_SHLIB="-shared"
-	    LDFLAGS_SHLIB_EXPORT=""
-	    SHLIB_SUFFIX_DEPTH=2
-	    ;;
 	*-netbsd*)
-	    CFLAGS_SHLIB="-fpic -DPIC"
-	    LDFLAGS_SHLIB="-Bshareable"
-	    LDFLAGS_SHLIB_EXPORT=""
+	    CFLAGS_SHLIB="-fPIC -DPIC"
+	    if echo __ELF__ | ${CC} -E - | grep -q __ELF__; then
+		LDFLAGS_SHLIB="-Bshareable"
+		LDFLAGS_SHLIB_EXPORT=""
+	    else
+		LDFLAGS_SHLIB="-shared"
+		LDFLAGS_SHLIB_EXPORT="-Wl,-E"
+	    fi
 	    SHLIB_SUFFIX_DEPTH=2
 	    ;;
 	*-bsdi)
