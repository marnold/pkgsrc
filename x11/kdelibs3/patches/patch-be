$NetBSD: patch-be,v 1.1.1.1.2.3 2002/08/22 11:13:43 jlam Exp $

--- kio/kssl/ksslcertificate.cc.orig	Wed Aug 14 15:48:38 2002
+++ kio/kssl/ksslcertificate.cc
@@ -90,7 +90,7 @@ public:
 KSSLCertificate::KSSLCertificate() {
   d = new KSSLCertificatePrivate;
   d->m_stateCached = false;
-  KGlobal::dirs()->addResourceType("kssl", "share/apps/kssl");
+  KGlobal::dirs()->addResourceType("kssl", KStandardDirs::kde_default("data") + "kssl");
 #ifdef HAVE_SSL
   d->m_cert = NULL;
 #endif
@@ -100,7 +100,7 @@ KSSLCertificate::KSSLCertificate() {
 KSSLCertificate::KSSLCertificate(const KSSLCertificate& x) {
   d = new KSSLCertificatePrivate;
   d->m_stateCached = false;
-  KGlobal::dirs()->addResourceType("kssl", "share/apps/kssl");
+  KGlobal::dirs()->addResourceType("kssl", KStandardDirs::kde_default("data") + "kssl");
 #ifdef HAVE_SSL
   d->m_cert = NULL;
   setCert(KOSSL::self()->X509_dup(const_cast<KSSLCertificate&>(x).getCert()));
@@ -541,9 +541,8 @@ KSSLCertificate::KSSLValidation KSSLCert
 
     //kdDebug(7029) << "KSSL setting CRL.............." << endl;
     // int X509_STORE_add_crl(X509_STORE *ctx, X509_CRL *x);
-    //
 
-    // int X509_STORE_CTX_set_purpose(X509_STORE_CTX *ctx, int purpose);
+    d->kossl->X509_STORE_CTX_set_purpose(certStoreCTX, X509_PURPOSE_SSL_SERVER);
 
     //kdDebug(7029) << "KSSL verifying.............." << endl;
     certStoreCTX->error = X509_V_OK;
