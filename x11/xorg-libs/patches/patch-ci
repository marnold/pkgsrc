$NetBSD: patch-ci,v 1.1.2.2 2006/09/16 10:27:05 salo Exp $

Fixes for CVE-2006-2006-3739 and CVE-2006-3740.

--- lib/font/Type1/util.c.orig	2006-09-13 14:22:13.000000000 +0200
+++ lib/font/Type1/util.c
@@ -104,7 +104,7 @@ vm_alloc(int bytes)
   bytes = (bytes + 7) & ~7;
  
   /* Allocate the space, if it is available */
-  if (bytes <= vm_free) {
+  if (bytes > 0 && bytes <= vm_free) {
     answer = vm_next;
     vm_free -= bytes;
     vm_next += bytes;
