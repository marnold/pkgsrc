$NetBSD: patch-cy,v 1.1.1.1.2.2 2002/06/23 19:05:46 jlam Exp $

--- ksmserver/Makefile.am.orig	Wed May  8 19:22:50 2002
+++ ksmserver/Makefile.am
@@ -20,18 +20,21 @@
 INCLUDES=  $(all_includes)
 
 bin_PROGRAMS = ksmserver
-lib_LTLIBRARIES = ksmserver.la
+lib_LTLIBRARIES = libksmserver_main.la ksmserver.la
 noinst_HEADERS = global.h server.h shutdown.h
 
 ksmserver_la_METASOURCES = AUTO
 # Order is important for --enable-final!
-ksmserver_la_SOURCES = main.cpp server.cpp shutdown.cpp
-ksmserver_SOURCES = dummy.cpp
+libksmserver_main_la_SOURCES = main.cpp server.cpp shutdown.cpp
+ksmserver_la_SOURCES = ksmserver_main.cpp
+ksmserver_SOURCES = ksmserver_main.cpp
 
+libksmserver_main_la_LDFLAGS = $(all_libraries)
 ksmserver_la_LDFLAGS = $(all_libraries) -avoid-version -module
 ksmserver_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-ksmserver_la_LIBADD = $(LIB_KDEUI)
-ksmserver_LDADD = ksmserver.la
+libksmserver_main_la_LIBADD = $(LIB_KDEUI)
+ksmserver_la_LIBADD = libksmserver_main.la
+ksmserver_LDADD = libksmserver_main.la
 
 picsdir = $(kde_datadir)/ksmserver/pics
 pics_DATA = shutdownkonq.png
@@ -48,6 +51,3 @@
 
 messages:
 	$(XGETTEXT) *.cpp -o $(podir)/ksmserver.pot
-
-dummy.cpp:
-	echo > dummy.cpp
