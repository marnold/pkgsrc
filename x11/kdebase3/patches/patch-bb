$NetBSD: patch-bb,v 1.1.1.1 2002/05/31 13:18:58 skrll Exp $

--- kdesktop/init.cc.orig	Thu Oct 11 12:19:53 2001
+++ kdesktop/init.cc
@@ -76,9 +76,13 @@
 {
   if (force || !QFile::exists(dir + "/.directory")) {
     QCString cmd;
-    cmd.sprintf( "cp %s %s/.directory",
+    QCString dest;
+    dest.sprintf( "%s/.directory", QFile::encodeName(dir).data() );
+    cmd.sprintf( "cp %s %s",
      QFile::encodeName(locate("data", QString("kdesktop/") + fileName)).data(),
-     QFile::encodeName(dir).data() );
+     dest.data() );
+    system( cmd );
+    cmd.sprintf( "chmod u+w %s", dest.data() );
     system( cmd );
   }
 }
@@ -102,10 +106,13 @@
     for (QStringList::ConstIterator it = list.begin(); it != list.end(); it++) {
 	QCString cmd = "cp '";
 	KDesktopFile desk( *it );
+	QCString dest = QFile::encodeName(desktopPath + desk.readName());
 	cmd += QFile::encodeName(*it);
 	cmd += "' '";
-	cmd += QFile::encodeName(desktopPath + desk.readName());
+	cmd += dest;
 	cmd += "'";
+	system( cmd );
+	cmd = "chmod u+w '" + dest + "'";
 	system( cmd );
     }
 }
