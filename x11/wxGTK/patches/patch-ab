$NetBSD: patch-ab,v 1.1.1.2 2000/08/31 22:24:00 dmcmahill Exp $

--- Makefile.in.orig	Sun Aug 20 04:52:53 2000
+++ Makefile.in	Thu Aug 31 16:20:35 2000
@@ -20,11 +20,11 @@
 
 .c.o :
-	$(CCC) -c @DEP_INFO_FLAGS@ $(CFLAGS) $(PICFLAGS) -o $@ $<
+	${LIBTOOL} --mode=compile $(CCC)  -c @DEP_INFO_FLAGS@ $(CFLAGS) -o $@ $<
 
 .cpp.o :
-	$(CC) -c @DEP_INFO_FLAGS@ $(CPPFLAGS) $(PICFLAGS) -o $@ $<
+	${LIBTOOL} --mode=compile $(CC) -c @DEP_INFO_FLAGS@ $(CPPFLAGS) -o $@ $<
 
 .cxx.o :
-	$(CC) -c @DEP_INFO_FLAGS@ $(CPPFLAGS) $(PICFLAGS) -o $@ $<
+	${LIBTOOL} --mode=compile $(CC) -c @DEP_INFO_FLAGS@ $(CPPFLAGS) -o $@ $<
 
 ########################### Paths #################################
@@ -79,8 +79,9 @@
 INSTALL_PROGRAM = @INSTALL_PROGRAM@
 INSTALL_DATA = @INSTALL_DATA@
+INSTALL_DATA_DIR = ${BSD_INSTALL_DATA_DIR}
 # my autoconf doesn't set this
-#INSTALL_SCRIPT = @INSTALL_SCRIPT@
+INSTALL_SCRIPT = @INSTALL_SCRIPT@
 # maybe do an additional chmod if needed?
-INSTALL_SCRIPT = @INSTALL@
+#INSTALL_SCRIPT = @INSTALL@
 transform = @program_transform_name@
 
@@ -304,8 +305,11 @@
 all: @WX_ALL@
 
-@WX_LIBRARY_NAME_STATIC@:  $(OBJECTS)
+CREATE_LINKS: $(top_builddir)/lib/@WX_LIBRARY_NAME@
+
+CREATE_INSTALLED_LINKS: preinstall
+
+$(top_builddir)/lib/@WX_LIBRARY_NAME@:  $(OBJECTS)
 	@$(INSTALL) -d ./lib
-	$(AR) $(AROPTIONS) ./lib/$@ $(OBJECTS)
-	$(RANLIB) ./lib/$@
+	${LIBTOOL} --mode=link cc -o $(top_builddir)/lib/@WX_LIBRARY_NAME@  ${OBJECTS:.o=.lo} -rpath ${PREFIX}/lib -version-info 0:1:1
 
 @WX_LIBRARY_NAME_STATIC_GL@:  glcanvas.o
@@ -314,52 +318,12 @@
 	$(RANLIB) ./lib/$@
 
-@WX_LIBRARY_NAME_SHARED@:  $(OBJECTS)
-	@$(INSTALL) -d ./lib
-	$(SHARED_LD) ./lib/$@ $(BURNT_LIBRARY_NAME) $(OBJECTS) $(EXTRALIBS)
-	
 @WX_LIBRARY_NAME_SHARED_GL@:  glcanvas.o
 	@$(INSTALL) -d ./lib
 	$(SHARED_LD) ./lib/$@ $(BURNT_LIBRARY_NAME_GL) glcanvas.o $(EXTRALIBS)
 	
-CREATE_LINKS: @WX_LIBRARY_NAME_SHARED@
-	@$(RM) ./lib/@WX_LIBRARY_LINK1@
-	@$(RM) ./lib/@WX_LIBRARY_LINK2@
-	@$(RM) ./lib/@WX_LIBRARY_LINK3@
-	cd lib \
-		&& $(LN_S) @WX_TARGET_LIBRARY@ @WX_LIBRARY_LINK1@ \
-		&& $(LN_S) @WX_TARGET_LIBRARY@ @WX_LIBRARY_LINK2@ \
-		&& $(LN_S) @WX_TARGET_LIBRARY@ @WX_LIBRARY_LINK3@
-	
-CREATE_LINKS_GL: @WX_LIBRARY_NAME_SHARED_GL@
-	@$(RM) ./lib/@WX_LIBRARY_LINK1_GL@
-	@$(RM) ./lib/@WX_LIBRARY_LINK2_GL@
-	@$(RM) ./lib/@WX_LIBRARY_LINK3_GL@
-	cd lib \
-		&& $(LN_S) @WX_TARGET_LIBRARY_GL@ @WX_LIBRARY_LINK1_GL@ \
-		&& $(LN_S) @WX_TARGET_LIBRARY_GL@ @WX_LIBRARY_LINK2_GL@ \
-		&& $(LN_S) @WX_TARGET_LIBRARY_GL@ @WX_LIBRARY_LINK3_GL@
-	
-CREATE_INSTALLED_LINKS: preinstall
-	$(RM) $(libdir)/@WX_LIBRARY_LINK1@
-	$(RM) $(libdir)/@WX_LIBRARY_LINK2@
-	$(RM) $(libdir)/@WX_LIBRARY_LINK3@
-	cd $(libdir) \
-		&& $(LN_S) @WX_LIBRARY_NAME_SHARED@ @WX_LIBRARY_LINK1@ \
-		&& $(LN_S) @WX_LIBRARY_NAME_SHARED@ @WX_LIBRARY_LINK2@ \
-		&& $(LN_S) @WX_LIBRARY_NAME_SHARED@ @WX_LIBRARY_LINK3@
-	
-CREATE_INSTALLED_LINKS_GL: preinstall_gl
-	$(RM) $(libdir)/@WX_LIBRARY_LINK1_GL@
-	$(RM) $(libdir)/@WX_LIBRARY_LINK2_GL@
-	$(RM) $(libdir)/@WX_LIBRARY_LINK3_GL@
-	cd $(libdir) \
-		&& $(LN_S) @WX_LIBRARY_NAME_SHARED_GL@ @WX_LIBRARY_LINK1_GL@ \
-		&& $(LN_S) @WX_LIBRARY_NAME_SHARED_GL@ @WX_LIBRARY_LINK2_GL@ \
-		&& $(LN_S) @WX_LIBRARY_NAME_SHARED_GL@ @WX_LIBRARY_LINK3_GL@
-	
 $(OBJECTS):	$(WXDIR)/include/wx/defs.h $(WXDIR)/include/wx/object.h
 
 parser.o:    parser.c lexer.c
-	$(CCLEX) -c $(CFLAGS) $(PICFLAGS) -o $@ parser.c
+	${LIBTOOL} --mode=compile $(CCLEX) -c $(CFLAGS)  -o $@ parser.c
 
 parser.c:	$(COMMDIR)/parser.y lexer.c
@@ -393,24 +357,22 @@
 # this is the real install target: copies the library, wx-config and the
 # headers to the installation directory
-preinstall: $(top_builddir)/lib/@WX_TARGET_LIBRARY@ $(top_builddir)/wx@TOOLKIT_NAME@-config
+preinstall: $(top_builddir)/lib/@WX_LIBRARY_NAME@ $(top_builddir)/wx@TOOLKIT_NAME@-config
 	@echo " "
 	@echo " Installing wxWindows..."
 	@echo " "
 
-	$(INSTALL) -d $(prefix)
-	$(INSTALL) -d $(bindir)
-	$(INSTALL) -d $(libdir)
 
 	$(INSTALL_SCRIPT) $(top_builddir)/wx@TOOLKIT_NAME@-config $(bindir)/wx@TOOLKIT_NAME@-config
 	cd $(bindir) && rm -f wx-config && $(LN_S) wx@TOOLKIT_NAME@-config wx-config
-	$(INSTALL_PROGRAM) $(top_builddir)/lib/@WX_TARGET_LIBRARY@ $(libdir)/@WX_TARGET_LIBRARY@
+	${LIBTOOL} --mode=install ${INSTALL_DATA} $(top_builddir)/lib/@WX_LIBRARY_NAME@ ${libdir}
+
 
-	$(INSTALL) -d $(libdir)/wx
-	$(INSTALL) -d $(libdir)/wx/include
-	$(INSTALL) -d $(libdir)/wx/include/wx
-	$(INSTALL) -d $(libdir)/wx/include/wx/@TOOLKIT_NAME@
+	$(INSTALL_DATA_DIR) $(libdir)/wx
+	$(INSTALL_DATA_DIR) $(libdir)/wx/include
+	$(INSTALL_DATA_DIR) $(libdir)/wx/include/wx
+	$(INSTALL_DATA_DIR) $(libdir)/wx/include/wx/@TOOLKIT_NAME@
 	$(INSTALL_DATA) $(top_builddir)/include/wx/@TOOLKIT_DIR@/setup.h $(libdir)/wx/include/wx/@TOOLKIT_NAME@/setup.h
 	
-	$(INSTALL) -d $(includedir)/wx
+	$(INSTALL_DATA_DIR) $(includedir)/wx
 	@if test "$(USE_GUI)" = 1; then $(INSTALL) -d $(includedir)/wx/@TOOLKIT_DIR@; fi
 	@if test "$(USE_GUI)" = 1; then $(INSTALL) -d $(includedir)/wx/html; fi
@@ -423,8 +385,8 @@
 	done
 
-	$(INSTALL) -d $(localedir)
+	$(INSTALL_DATA_DIR) (localedir)
 	@for p in $(WX_LINGUAS); do \
-	  $(INSTALL) -d $(localedir)/$$p; \
-	  $(INSTALL) -d $(localedir)/$$p/LC_MESSAGES; \
+	  $(INSTALL_DATA_DIR) $(localedir)/$$p; \
+	  $(INSTALL_DATA_DIR) $(localedir)/$$p/LC_MESSAGES; \
 	  $(INSTALL_DATA) $(top_srcdir)/locale/$$p.mo $(localedir)/$$p/LC_MESSAGES/wxstd.mo; \
 	  echo "$(INSTALL_DATA) $(top_srcdir)/locale/$$p.mo $(localedir)/$$p/LC_MESSAGES/wxstd.mo"; \
