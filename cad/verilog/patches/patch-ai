$NetBSD: patch-ai,v 1.1.1.1 2000/01/26 15:28:41 dmcmahill Exp $

--- configure.in.orig	Mon Nov 29 12:02:21 1999
+++ configure.in	Sun Jan 23 12:59:12 2000
@@ -1,4 +1,5 @@
 dnl Process this file with autoconf to produce a configure script.
 AC_INIT(netlist.h)
+AC_CONFIG_HEADER(machine.h)
 
 dnl Checks for programs.
@@ -8,4 +9,44 @@
 AC_CHECK_HEADERS(getopt.h)
 AC_PROG_INSTALL
+AC_CHECK_LIB(dl,main,[DLLIB=-ldl])
+AC_SUBST(DLLIB)
+
+#######################
+## test for underscores
+#######################
+
+AC_MSG_CHECKING("for leading and/or trailing underscores")
+cat << EOF > underscore.c
+       void underscore(void){}
+EOF
+$CC -c underscore.c > /dev/null 2>&1
+
+CC_LEADING_UNDERSCORE=no
+CC_TRAILING_UNDERSCORE=no
+
+output=`nm underscore.o|grep _underscore 2>&1`
+if test ! -z "$output"; then
+  CC_LEADING_UNDERSCORE=yes
+fi
+
+output=`nm underscore.o|grep underscore_ 2>&1`
+if test ! -z "$output"; then
+  CC_TRAILING_UNDERSCORE=yes
+fi
+
+if test "$CC_LEADING_UNDERSCORE" = yes; then
+  AC_DEFINE(WLU)
+fi
+if test "$CC_TRAILING_UNDERSCORE" = yes; then
+  AC_DEFINE(WTU)
+fi
+
+rm underscore.c underscore.o
+
+AC_MSG_RESULT("$CC_LEADING_UNDERSCORE $CC_TRAILING_UNDERSCORE")
+
+#######################
+## end of test for underscores
+#######################
 
 AC_OUTPUT(Makefile vpi/Makefile ivlpp/Makefile vvm/Makefile)
