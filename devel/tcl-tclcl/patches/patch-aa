$NetBSD: patch-aa,v 1.1.1.1 2002/08/28 10:00:12 seb Exp $

--- Makefile.in.orig	Thu Nov  9 20:48:33 2000
+++ Makefile.in
@@ -52,6 +52,9 @@ TEST	= test
 RM	= rm -f
 PERL	= perl
 
+INSTALL_DATA = ${BSD_INSTALL_DATA}
+INSTALL_PROGRAM = ${BSD_INSTALL_PROGRAM}
+INSTALL_SCRIPT = ${BSD_INSTALL_SCRIPT}
 
 CCOPT	= @V_CCOPT@
 STATIC	= @V_STATIC@
@@ -75,11 +78,11 @@ CFLAGS	= $(CCOPT) $(DEFINE)
 
 .cc.o:
 	@rm -f $@
-	$(CPP) -c $(CFLAGS) $(INCLUDES) -o $@ $*.cc
+	${LIBTOOL} --mode=compile $(CPP) -c $(CFLAGS) $(INCLUDES) -o $@ $*.cc
 
 .c.o:
 	@rm -f $@
-	$(CC) -c $(CFLAGS) $(INCLUDES) -o $@ $*.c
+	${LIBTOOL} --mode=compile $(CC) -c $(CFLAGS) $(INCLUDES) -o $@ $*.c
 
 
 GEN_DIR	= gen/
@@ -103,7 +106,7 @@ TCL_82_LIBRARY_FILES = \
 	$(LIBRARY_TCL)/http2.1/http.tcl
 TCL_83_LIBRARY_FILES = \
 	$(TCL_BASE_LIBRARY_FILES) \
-	$(LIBRARY_TCL)/http2.3/http.tcl
+	$(LIBRARY_TCL)/http2.4/http.tcl
 
 TCL_LIBRARY_FILES = \
 	@V_TCL_LIBRARY_FILES@
@@ -149,13 +152,12 @@ all:	$(TCL2C) $(LIB_TCLCL)
 
 $(TCL2C): tcl2c++.o
 	$(RM) $@
-	$(LINK) $(STATIC) $(LDFLAGS) $(LDOUT)$@ tcl2c++.o
+	${LIBTOOL} --mode=link $(LINK) $(LDOUT)$@ tcl2c++.o
 
 # We used to link to libTcl.a for backwards compatibilty, but no more.
 $(LIB_TCLCL): $(OBJ_CC) $(OBJ_COMPAT_C)
 	$(RM) $@
-	$(AR)$@ $(OBJ_CC) $(OBJ_COMPAT_C)
-	$(RANLIB) $@
+	${LIBTOOL} --mode=link ${CPP} -o ${.TARGET:.a=.la} $(OBJ_CC:.o=.lo) $(OBJ_COMPAT_C:.o=.lo) -rpath ${PREFIX}/lib -version-info 0:0
 
 #
 # pass-1 embedded tcl files
@@ -180,9 +182,12 @@ embedded-console.cc: $(CONSOLE_FILES) $(
 	$(TCL2C) et_console $(CONSOLE_FILES) > embedded-console.cc
 
 install: force
-	$(INSTALL) *.h @prefix@/include
-	$(INSTALL) tcl2c++ @prefix@/bin
-	$(INSTALL) $(LIB_TCLCL) @prefix@/lib
+	for f in *.h ; do				\
+		${INSTALL_DATA} $$f ${PREFIX}/include;	\
+	done
+	${INSTALL_PROGRAM} tcl2c++ ${PREFIX}/bin
+	${INSTALL_SCRIPT} otcldoc ${PREFIX}/bin
+	${LIBTOOL} --mode=install ${BSD_INSTALL_DATA} libtclcl.la ${PREFIX}/lib
 
 # libTcl is no longer installed as of 13-Nov-99
 #	-test -f @prefix@/lib/libTcl.a && rm -f @prefix@/lib/libTcl.a || true
