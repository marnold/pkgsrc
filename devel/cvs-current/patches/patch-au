$NetBSD: patch-au,v 1.1.1.1 1999/07/26 23:38:49 cjs Exp $

--- src/commit.c.orig	Thu Aug  6 20:04:11 1998
+++ src/commit.c	Tue May 25 10:25:05 1999
@@ -984,7 +984,9 @@
 		  xmalloc (sizeof (struct logfile_info)));
 	    li->type = status;
 	    li->tag = xstrdup (vers->tag);
-	    li->rev_old = xstrdup (vers->vn_rcs);
+	    /* If the file was re-added, we want the revision in the commitlog
+	       to be NONE, not the previous dead revision. */
+	    li->rev_old = status == T_ADDED ? NULL : xstrdup (vers->vn_rcs);
 	    li->rev_new = NULL;
 	    p->data = (char *) li;
 	    (void) addnode (ulist, p);
