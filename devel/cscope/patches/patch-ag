$NetBSD: patch-ag,v 1.4.2.1 2006/08/25 11:05:02 ghen Exp $

--- src/command.c.orig	2002-07-29 14:37:49.000000000 +0200
+++ src/command.c	2006-08-24 23:31:53.000000000 +0200
@@ -707,7 +707,7 @@ changestring(void)
 	(void) fprintf(script, "ed - <<\\!\n");
 	*oldfile = '\0';
 	seekline(1);
-	for (i = 0; fscanf(refsfound, "%s%*s%s%*[^\n]", newfile, linenum) == 2;
+	for (i = 0; fscanf(refsfound, "%" PATHLEN_STR "s%*s%" NUMLEN_STR "s%*[^\n]", newfile, linenum) == 2;
 	    ++i) {
 		/* see if the line is to be changed */
 		if (change[i] == YES) {
@@ -718,7 +718,7 @@ changestring(void)
 				
 				/* make sure it can be changed */
 				if (access(newfile, WRITE) != 0) {
-					(void) sprintf(msg, "Cannot write to file %s", newfile);
+					(void) snprintf(msg, sizeof(msg), "Cannot write to file %s", newfile);
 					postmsg(msg);
 					anymarked = NO;
 					break;
