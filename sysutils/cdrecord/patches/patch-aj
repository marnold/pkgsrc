$NetBSD: patch-aj,v 1.2.2.1 2002/06/23 18:59:45 jlam Exp $

--- cdrecord/scsi_cdr.c.orig	Wed Apr 11 00:22:21 2001
+++ cdrecord/scsi_cdr.c	Wed May 15 19:55:52 2002
@@ -271,6 +271,12 @@
 request_sense(scgp)
 	SCSI	*scgp;
 {
+
+#ifdef __NetBSD__
+	/* request sense already done by kernel */
+	scg_prsense((Uchar *)scgp->scmd->u_sense.cmd_sense,
+	    scgp->scmd->sense_count);
+#else	
 		 char	sensebuf[CCS_SENSE_LEN];
 	register struct	scg_cmd	*scmd = scgp->scmd;
 
@@ -290,6 +296,7 @@
 	if (scg_cmd(scgp) < 0)
 		return (-1);
 	scg_prsense((Uchar *)sensebuf, CCS_SENSE_LEN - scg_getresid(scgp));
+#endif
 	return (0);
 }
 
@@ -1741,9 +1748,9 @@
 
 	fillbytes(mode, sizeof(mode), '\0');
 	scgp->silent++;
-	if (mode_sense(scgp, mode, 0xFF, 0x3F, current?0:2) < 0) {	/* All Pages */
+	if (mode_sense(scgp, mode, 0xFE, 0x3F, current?0:2) < 0) {	/* All Pages */
 		fillbytes(mode, sizeof(mode), '\0');
-		if (mode_sense(scgp, mode, 0xFF, 0, current?0:2) < 0)	{/* VU (block desc) */
+		if (mode_sense(scgp, mode, 0xFE, 0, current?0:2) < 0)	{/* VU (block desc) */
 			scgp->silent--;
 			return (-1);
 		}
