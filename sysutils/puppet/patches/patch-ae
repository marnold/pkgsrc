$NetBSD: patch-ae,v 1.1.2.2 2010/02/04 23:13:24 spz Exp $

Fix for CVE-2009-3564.

--- lib/puppet/util.rb.orig	2010-02-03 01:16:24.000000000 +0000
+++ lib/puppet/util.rb
@@ -58,10 +58,11 @@ module Util
             end
             unless Puppet::Util::SUIDManager.uid == user
                 begin
+                    Puppet::Util::SUIDManager.initgroups(user)
                     Puppet::Util::SUIDManager.uid = user 
                     Puppet::Util::SUIDManager.euid = user 
-                rescue
-                    $stderr.puts "could not change to user %s" % user
+                rescue => detail
+                    $stderr.puts "Could not change to user %s: %s" % [user, detail]
                     exit(74)
                 end
             end
