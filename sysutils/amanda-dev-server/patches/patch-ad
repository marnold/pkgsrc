$NetBSD: patch-ad,v 1.1.1.1 2002/05/02 13:28:16 bouyer Exp $

--- server-src/Makefile.in.orig	Fri Mar  8 20:29:44 2002
+++ server-src/Makefile.in	Tue Apr 30 13:08:50 2002
@@ -196,10 +196,7 @@
 # need to list libamanda twice here, first to override the system library
 # routines, and second to pick up any references in the other libraries.
 ###
-LDADD = ../common-src/libamanda.$(LIB_EXTENSION) \
-	libamserver.$(LIB_EXTENSION) \
-	../tape-src/libamtape.$(LIB_EXTENSION) \
-	../common-src/libamanda.$(LIB_EXTENSION)
+LDADD = libamserver.$(LIB_EXTENSION)
 
 
 SUFFIXES = .sh .pl
@@ -264,155 +261,98 @@
 amadmin_SOURCES = amadmin.c
 amadmin_OBJECTS = amadmin.$(OBJEXT)
 amadmin_LDADD = $(LDADD)
-amadmin_DEPENDENCIES = ../common-src/libamanda.$(LIB_EXTENSION) \
-	libamserver.$(LIB_EXTENSION) \
-	../tape-src/libamtape.$(LIB_EXTENSION) \
-	../common-src/libamanda.$(LIB_EXTENSION)
+amadmin_DEPENDENCIES = libamserver.$(LIB_EXTENSION)
 amadmin_LDFLAGS =
 amcheck_SOURCES = amcheck.c
 amcheck_OBJECTS = amcheck.$(OBJEXT)
 amcheck_LDADD = $(LDADD)
-amcheck_DEPENDENCIES = ../common-src/libamanda.$(LIB_EXTENSION) \
-	libamserver.$(LIB_EXTENSION) \
-	../tape-src/libamtape.$(LIB_EXTENSION) \
-	../common-src/libamanda.$(LIB_EXTENSION)
+amcheck_DEPENDENCIES = libamserver.$(LIB_EXTENSION)
 amcheck_LDFLAGS =
 amcleanupdisk_SOURCES = amcleanupdisk.c
 amcleanupdisk_OBJECTS = amcleanupdisk.$(OBJEXT)
 amcleanupdisk_LDADD = $(LDADD)
-amcleanupdisk_DEPENDENCIES = ../common-src/libamanda.$(LIB_EXTENSION) \
-	libamserver.$(LIB_EXTENSION) \
-	../tape-src/libamtape.$(LIB_EXTENSION) \
-	../common-src/libamanda.$(LIB_EXTENSION)
+amcleanupdisk_DEPENDENCIES = libamserver.$(LIB_EXTENSION)
 amcleanupdisk_LDFLAGS =
 amflush_SOURCES = amflush.c
 amflush_OBJECTS = amflush.$(OBJEXT)
 amflush_LDADD = $(LDADD)
-amflush_DEPENDENCIES = ../common-src/libamanda.$(LIB_EXTENSION) \
-	libamserver.$(LIB_EXTENSION) \
-	../tape-src/libamtape.$(LIB_EXTENSION) \
-	../common-src/libamanda.$(LIB_EXTENSION)
+amflush_DEPENDENCIES = libamserver.$(LIB_EXTENSION)
 amflush_LDFLAGS =
 am_amgetconf_OBJECTS = getconf.$(OBJEXT)
 amgetconf_OBJECTS = $(am_amgetconf_OBJECTS)
 amgetconf_LDADD = $(LDADD)
-amgetconf_DEPENDENCIES = ../common-src/libamanda.$(LIB_EXTENSION) \
-	libamserver.$(LIB_EXTENSION) \
-	../tape-src/libamtape.$(LIB_EXTENSION) \
-	../common-src/libamanda.$(LIB_EXTENSION)
+amgetconf_DEPENDENCIES = libamserver.$(LIB_EXTENSION)
 amgetconf_LDFLAGS =
 am_amindexd_OBJECTS = amindexd.$(OBJEXT) disk_history.$(OBJEXT) \
 	list_dir.$(OBJEXT)
 amindexd_OBJECTS = $(am_amindexd_OBJECTS)
 amindexd_LDADD = $(LDADD)
-amindexd_DEPENDENCIES = ../common-src/libamanda.$(LIB_EXTENSION) \
-	libamserver.$(LIB_EXTENSION) \
-	../tape-src/libamtape.$(LIB_EXTENSION) \
-	../common-src/libamanda.$(LIB_EXTENSION)
+amindexd_DEPENDENCIES = libamserver.$(LIB_EXTENSION)
 amindexd_LDFLAGS =
 amlabel_SOURCES = amlabel.c
 amlabel_OBJECTS = amlabel.$(OBJEXT)
 amlabel_LDADD = $(LDADD)
-amlabel_DEPENDENCIES = ../common-src/libamanda.$(LIB_EXTENSION) \
-	libamserver.$(LIB_EXTENSION) \
-	../tape-src/libamtape.$(LIB_EXTENSION) \
-	../common-src/libamanda.$(LIB_EXTENSION)
+amlabel_DEPENDENCIES = libamserver.$(LIB_EXTENSION)
 amlabel_LDFLAGS =
 amlogroll_SOURCES = amlogroll.c
 amlogroll_OBJECTS = amlogroll.$(OBJEXT)
 amlogroll_LDADD = $(LDADD)
-amlogroll_DEPENDENCIES = ../common-src/libamanda.$(LIB_EXTENSION) \
-	libamserver.$(LIB_EXTENSION) \
-	../tape-src/libamtape.$(LIB_EXTENSION) \
-	../common-src/libamanda.$(LIB_EXTENSION)
+amlogroll_DEPENDENCIES = libamserver.$(LIB_EXTENSION)
 amlogroll_LDFLAGS =
 am_amreport_OBJECTS = reporter.$(OBJEXT)
 amreport_OBJECTS = $(am_amreport_OBJECTS)
 amreport_LDADD = $(LDADD)
-amreport_DEPENDENCIES = ../common-src/libamanda.$(LIB_EXTENSION) \
-	libamserver.$(LIB_EXTENSION) \
-	../tape-src/libamtape.$(LIB_EXTENSION) \
-	../common-src/libamanda.$(LIB_EXTENSION)
+amreport_DEPENDENCIES = libamserver.$(LIB_EXTENSION)
 amreport_LDFLAGS =
 amtape_SOURCES = amtape.c
 amtape_OBJECTS = amtape.$(OBJEXT)
 amtape_LDADD = $(LDADD)
-amtape_DEPENDENCIES = ../common-src/libamanda.$(LIB_EXTENSION) \
-	libamserver.$(LIB_EXTENSION) \
-	../tape-src/libamtape.$(LIB_EXTENSION) \
-	../common-src/libamanda.$(LIB_EXTENSION)
+amtape_DEPENDENCIES = libamserver.$(LIB_EXTENSION)
 amtape_LDFLAGS =
 amtrmidx_SOURCES = amtrmidx.c
 amtrmidx_OBJECTS = amtrmidx.$(OBJEXT)
 amtrmidx_LDADD = $(LDADD)
-amtrmidx_DEPENDENCIES = ../common-src/libamanda.$(LIB_EXTENSION) \
-	libamserver.$(LIB_EXTENSION) \
-	../tape-src/libamtape.$(LIB_EXTENSION) \
-	../common-src/libamanda.$(LIB_EXTENSION)
+amtrmidx_DEPENDENCIES = libamserver.$(LIB_EXTENSION)
 amtrmidx_LDFLAGS =
 amtrmlog_SOURCES = amtrmlog.c
 amtrmlog_OBJECTS = amtrmlog.$(OBJEXT)
 amtrmlog_LDADD = $(LDADD)
-amtrmlog_DEPENDENCIES = ../common-src/libamanda.$(LIB_EXTENSION) \
-	libamserver.$(LIB_EXTENSION) \
-	../tape-src/libamtape.$(LIB_EXTENSION) \
-	../common-src/libamanda.$(LIB_EXTENSION)
+amtrmlog_DEPENDENCIES = libamserver.$(LIB_EXTENSION)
 amtrmlog_LDFLAGS =
 am_conffile_OBJECTS = conffile.test.$(OBJEXT)
 conffile_OBJECTS = $(am_conffile_OBJECTS)
 conffile_LDADD = $(LDADD)
-conffile_DEPENDENCIES = ../common-src/libamanda.$(LIB_EXTENSION) \
-	libamserver.$(LIB_EXTENSION) \
-	../tape-src/libamtape.$(LIB_EXTENSION) \
-	../common-src/libamanda.$(LIB_EXTENSION)
+conffile_DEPENDENCIES = libamserver.$(LIB_EXTENSION)
 conffile_LDFLAGS =
 am_diskfile_OBJECTS = diskfile.test.$(OBJEXT)
 diskfile_OBJECTS = $(am_diskfile_OBJECTS)
 diskfile_LDADD = $(LDADD)
-diskfile_DEPENDENCIES = ../common-src/libamanda.$(LIB_EXTENSION) \
-	libamserver.$(LIB_EXTENSION) \
-	../tape-src/libamtape.$(LIB_EXTENSION) \
-	../common-src/libamanda.$(LIB_EXTENSION)
+diskfile_DEPENDENCIES = libamserver.$(LIB_EXTENSION)
 diskfile_LDFLAGS =
 driver_SOURCES = driver.c
 driver_OBJECTS = driver.$(OBJEXT)
 driver_LDADD = $(LDADD)
-driver_DEPENDENCIES = ../common-src/libamanda.$(LIB_EXTENSION) \
-	libamserver.$(LIB_EXTENSION) \
-	../tape-src/libamtape.$(LIB_EXTENSION) \
-	../common-src/libamanda.$(LIB_EXTENSION)
+driver_DEPENDENCIES = libamserver.$(LIB_EXTENSION)
 driver_LDFLAGS =
 dumper_SOURCES = dumper.c
 dumper_OBJECTS = dumper.$(OBJEXT)
 dumper_LDADD = $(LDADD)
-dumper_DEPENDENCIES = ../common-src/libamanda.$(LIB_EXTENSION) \
-	libamserver.$(LIB_EXTENSION) \
-	../tape-src/libamtape.$(LIB_EXTENSION) \
-	../common-src/libamanda.$(LIB_EXTENSION)
+dumper_DEPENDENCIES = libamserver.$(LIB_EXTENSION)
 dumper_LDFLAGS =
 am_infofile_OBJECTS = infofile.test.$(OBJEXT)
 infofile_OBJECTS = $(am_infofile_OBJECTS)
 infofile_LDADD = $(LDADD)
-infofile_DEPENDENCIES = ../common-src/libamanda.$(LIB_EXTENSION) \
-	libamserver.$(LIB_EXTENSION) \
-	../tape-src/libamtape.$(LIB_EXTENSION) \
-	../common-src/libamanda.$(LIB_EXTENSION)
+infofile_DEPENDENCIES = libamserver.$(LIB_EXTENSION)
 infofile_LDFLAGS =
 planner_SOURCES = planner.c
 planner_OBJECTS = planner.$(OBJEXT)
 planner_LDADD = $(LDADD)
-planner_DEPENDENCIES = ../common-src/libamanda.$(LIB_EXTENSION) \
-	libamserver.$(LIB_EXTENSION) \
-	../tape-src/libamtape.$(LIB_EXTENSION) \
-	../common-src/libamanda.$(LIB_EXTENSION)
+planner_DEPENDENCIES = libamserver.$(LIB_EXTENSION)
 planner_LDFLAGS =
 taper_SOURCES = taper.c
 taper_OBJECTS = taper.$(OBJEXT)
 taper_LDADD = $(LDADD)
-taper_DEPENDENCIES = ../common-src/libamanda.$(LIB_EXTENSION) \
-	libamserver.$(LIB_EXTENSION) \
-	../tape-src/libamtape.$(LIB_EXTENSION) \
-	../common-src/libamanda.$(LIB_EXTENSION)
+taper_DEPENDENCIES = libamserver.$(LIB_EXTENSION)
 taper_LDFLAGS =
 SCRIPTS = $(sbin_SCRIPTS)
 
@@ -421,7 +361,7 @@
 DEFAULT_INCLUDES =  -I. -I$(srcdir) -I$(top_builddir)/config
 CPPFLAGS = @CPPFLAGS@
 LDFLAGS = @LDFLAGS@
-LIBS = @LIBS@
+LIBS = @LIBS@ -lamtape -lamanda
 depcomp = $(SHELL) $(top_srcdir)/config/depcomp
 @AMDEP_TRUE@DEP_FILES = $(DEPDIR)/amadmin.Po $(DEPDIR)/amcheck.Po \
 @AMDEP_TRUE@	$(DEPDIR)/amcleanupdisk.Po $(DEPDIR)/amflush.Po \
