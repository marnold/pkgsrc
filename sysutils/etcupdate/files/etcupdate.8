.\"	$NetBSD: etcupdate.8,v 1.1.1.1 2001/11/20 09:53:55 martti Exp $
.\"
.\" Copyright (c) 2001 The NetBSD Foundation, Inc.
.\" All rights reserved.
.\"
.\" This code is derived from software contributed to The NetBSD Foundation
.\" by Martti Kuparinen.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"        This product includes software developed by the NetBSD
.\"        Foundation, Inc. and its contributors.
.\" 4. Neither the name of The NetBSD Foundation nor the names of its
.\"    contributors may be used to endorse or promote products derived
.\"    from this software without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE NETBSD FOUNDATION, INC. AND CONTRIBUTORS
.\" ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
.\" TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
.\" PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE FOUNDATION OR CONTRIBUTORS
.\" BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
.\" CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
.\" SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
.\" INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
.\" CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
.\" ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
.\" POSSIBILITY OF SUCH DAMAGE.
.\"
.Dd November 14, 2001
.Dt ETCUPDATE 8
.Os
.Sh NAME
.Nm etcupdate
.Nd update the configuration files in
.Pa /etc
.Sh SYNOPSIS
.Nm
.Op Fl h
.Op Fl p Ar pager
.Op Fl s Ar srcdir
.Op Fl t Ar temproot
.Op Fl v
.Op Fl w Ar width
.Sh DESCRIPTION
.Pa etcupdate
is a tool to update the configuration files in
.Pa /etc
without the need of manually checking and modifying every file.
The user should run this script after performing an operating system
update (i.e. after running
.Pa make build
in
.Pa /usr/src
) to use the latest configuration files during reboot.

.Pa etcupdate
will first create a copy of the new configuration files and compare these
against the installed files. The user is given an option of installing,
merging or deleting of each modified or missing files.

.Pa etcupdate
also notes if the user installs certain special files and performs
corresponding tasks like remaking the device nodes or rebuilding a database
from the
.Pa /etc/mail/aliases
file.
.Sh ENVIRONMENT
.Pa TEMPROOT

The temporary files created from
.Pa /usr/src/etc
will be stored here. These files will then be compared
against the currently installed files in the
.Pa /etc
directory. By default this is
.Pa /tmp/temproot
but can be changed either with the
.Fl t Ar temproot
argument or by defining the
.Pa TEMPROOT
variable.

.Pa SRCDIR

The location of the NetBSD sources files. By default this is
.Pa /usr/src
but can be changed either with the
.Fl s Ar srcdir
argument or by defining the
.Pa SRCDIR
variable.

.Pa PAGER

The pager to use when displaying files. By default this is
.Pa /usr/bin/more
but can be changed either with the
.Fl p Ar pager
argument or by defining the
.Pa PAGER
variable.

.Pa WIDTH

The screen width used during interactive merge. By default this is 
.Pa 80
but can be changed either with the
.Fl w Ar width
argument or by defining the
.Pa WIDTH
variable.
This is useful for
.Pa xterm(1)
users with wider shell windows.
.Sh FILES
The environment variables can also be defined in the following configuration
files. The user's personal configuration file settings override the global
settings.

.Pa /etc/etcupdate.conf

.Pa ~/.etcupdaterc
.Sh EXAMPLES
You have just upgraded your NetBSD host from 1.5.2 to 1.5.3 and now it's time
to update the configuration files as well. This can be done with the
following command:

.Dl etcupdate

To get a better idea what's going on, use the
.Fl v
flag:

.Dl etcupdate -v

The default location of the source files is
.Pa /usr/src
but this may be overridden with the
.Fl s Ar srcdir
command line argument:

.Dl etcupdate -s /some/where/src
.Sh HISTORY
The
.Pa etcupdate
command appeared in NetBSD 1.5.3.
.Sh AUTHORS
The
script was written by Martti Kuparinen <martti@netbsd.org> and
improved by several other NetBSD users.

The idea for this script (including code fragments, variable names etc.)
came from the FreeBSD mergemaster (by Douglas Barton). Unlike the
FreeBSD mergemaster, this does not use CVS version tags to compare if
the files need to be updated. Files are compared with
.Pa /usr/bin/cmp
as this is more reliable and the only way if the version numbers are
same even though the files are different.
