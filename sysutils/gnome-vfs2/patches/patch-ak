$NetBSD: patch-ak,v 1.7.14.1 2006/07/09 21:20:06 salo Exp $

http://bugzilla.gnome.org/show_bug.cgi?id=337993

--- imported/neon/ne_gnutls.c.orig	2006-06-26 16:17:37.000000000 -0700
+++ imported/neon/ne_gnutls.c
@@ -0,0 +1,26 @@
+#include "config.h"
+
+#include <gnutls/gnutls.h>
+
+#include "ne_ssl.h"
+
+#include "ne_private.h"
+#include "ne_privssl.h"
+
+struct ne_ssl_dname_s {
+    int subject; /* non-zero if this is the subject DN object */
+    gnutls_x509_crt cert;
+};
+
+struct ne_ssl_certificate_s {
+    ne_ssl_dname subj_dn, issuer_dn;
+    gnutls_x509_crt subject;
+    ne_ssl_certificate *issuer;
+    char *identity;
+};
+
+void ne_ssl_context_trustcert(ne_ssl_context *ctx, const ne_ssl_certificate *cert)
+{
+    gnutls_x509_crt certs = cert->subject;
+    gnutls_certificate_set_x509_trust(ctx->cred, &certs, 1);
+}
