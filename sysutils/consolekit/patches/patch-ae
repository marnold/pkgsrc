$NetBSD: patch-ae,v 1.1.1.1 2008/11/22 03:32:22 jmcneill Exp $

--- src/ck-sysdeps-unix.c.orig	2008-01-23 09:30:44.000000000 -0500
+++ src/ck-sysdeps-unix.c
@@ -35,6 +35,10 @@
 #include <linux/kd.h>
 #endif
 
+#ifdef __NetBSD__
+#include <dev/wscons/wsdisplay_usl_io.h>
+#endif
+
 #ifdef HAVE_SYS_VT_H
 #include <sys/vt.h>
 #endif
@@ -126,7 +130,7 @@ ck_get_socket_peer_credentials   (int   
 gboolean
 ck_fd_is_a_console (int fd)
 {
-#ifdef __linux__
+#if defined(__linux__) || defined(__NetBSD__)
         struct vt_stat vts;
 #elif defined(__FreeBSD__)
         int vers;
@@ -134,7 +138,7 @@ ck_fd_is_a_console (int fd)
         int  kb_ok;
 
         errno = 0;
-#ifdef __linux__
+#if defined(__linux__) || defined(__NetBSD__)
         kb_ok = (ioctl (fd, VT_GETSTATE, &vts) == 0);
 #elif defined(__FreeBSD__)
         kb_ok = (ioctl (fd, CONS_GETVERS, &vers) == 0);
