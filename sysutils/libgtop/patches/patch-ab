$NetBSD: patch-ab,v 1.1.1.2 2004/04/02 12:10:12 jmmv Exp $

--- sysdeps/freebsd/procsignal.c.orig	Sun Feb 13 22:31:39 2000
+++ sysdeps/freebsd/procsignal.c	Wed Jan  3 00:42:45 2001
@@ -70,7 +70,9 @@
 	/* signal: mask of pending signals.
 	 *         pinfo [0].kp_proc.p_siglist
 	 */
-#if (defined(__NetBSD__) && (NSIG > 32)) || (__FreeBSD_version >= 400011)
+#if defined(__NetBSD__) && (__NetBSD_Version__ > 105150000)
+	buf->signal [0] = pinfo [0].kp_proc.p_sigctx.ps_siglist.__bits[0];
+#elif (defined(__NetBSD__) && (NSIG > 32)) || (__FreeBSD_version >= 400011)
 	buf->signal [0] = pinfo [0].kp_proc.p_siglist.__bits[0];
 #else
 	buf->signal [0] = pinfo [0].kp_proc.p_siglist;
@@ -79,7 +81,9 @@
 	/* blocked: mask of blocked signals.
 	 *          pinfo [0].kp_proc.p_sigmask
 	 */
-#if (defined(__NetBSD__) && (NSIG > 32)) || (__FreeBSD_version >= 400011)
+#if defined(__NetBSD__) && (__NetBSD_Version__ > 105150000)
+	buf->blocked [0] = pinfo [0].kp_proc.p_sigctx.ps_sigmask.__bits[0];
+#elif (defined(__NetBSD__) && (NSIG > 32)) || (__FreeBSD_version >= 400011)
 	buf->blocked [0] = pinfo [0].kp_proc.p_sigmask.__bits[0];
 #else
 	buf->blocked [0] = pinfo [0].kp_proc.p_sigmask;
@@ -88,7 +92,9 @@
 	/* sigignore: mask of ignored signals.
 	 *            pinfo [0].kp_proc.p_sigignore
 	*/
-#if (defined(__NetBSD__) && (NSIG > 32)) || (__FreeBSD_version >= 400011)
+#if defined(__NetBSD__) && (__NetBSD_Version__ > 105150000)
+	buf->sigignore [0] = pinfo [0].kp_proc.p_sigctx.ps_sigignore.__bits[0];
+#elif (defined(__NetBSD__) && (NSIG > 32)) || (__FreeBSD_version >= 400011)
 	buf->sigignore [0] = pinfo [0].kp_proc.p_sigignore.__bits[0];
 #else
 	buf->sigignore [0] = pinfo [0].kp_proc.p_sigignore;
@@ -97,7 +103,9 @@
 	/* sigcatch: mask of caught signals.
 	 *           pinfo [0].kp_proc.p_sigcatch
 	*/
-#if (defined(__NetBSD__) && (NSIG > 32)) || (__FreeBSD_version >= 400011)
+#if defined(__NetBSD__) && (__NetBSD_Version__ > 105150000)
+	buf->sigcatch [0] = pinfo [0].kp_proc.p_sigctx.ps_sigcatch.__bits[0];
+#elif (defined(__NetBSD__) && (NSIG > 32)) || (__FreeBSD_version >= 400011)
 	buf->sigcatch [0] = pinfo [0].kp_proc.p_sigcatch.__bits[0];
 #else
 	buf->sigcatch [0] = pinfo [0].kp_proc.p_sigcatch;
