$NetBSD: patch-aa,v 1.1.1.1 2004/01/07 15:12:59 ben Exp $
--- ../upx-1.24/src/Makefile	2002-10-28 11:43:34.000000000 +0100
+++ src/Makefile	2003-12-27 22:03:08.000000000 +0100
@@ -187,6 +187,39 @@ LDFLAGS += $(LDLIBDIRS)
 
 
 ###
+### NetBSD
+###
+
+ifeq ($(target),netbsd)
+override arch := $(shell uname -m | sed -e 's/^i[3456789]86$$/i386/')
+DEFS += '-DUPX_CONFIG_H="config_h/linux.h"'
+DEFS += -D_FILE_OFFSET_BITS=64  -DWITH_UCL=1
+LDLIBS += -lucl
+ifeq ($(arch),i386)
+  CC += -march=i386 -mcpu=i586
+endif
+
+ifeq (1,2) 	# checkergcc
+  CC = checkergcc
+  CXX = checkerg++
+else
+ifeq ($(DEBUG),1)
+  CFLAGS += -O0 -g
+else
+  ##LDFLAGS += -static
+  STUBEDIT_EXE = objcopy -S -R .comment -R .note $@
+  ifeq ($(arch),i386)
+    STUBIFY_EXE = perl $(srcdir)/stub/scripts/brandelf.pl $@
+    CHMOD_EXE = chmod 755 $@
+  endif
+endif
+endif
+LDFLAGS += -L$(PREFIX)/lib -Wl,-rpath=$(PREFIX)/lib
+CFLAGS += -I$(PREFIX)/include
+CC = g++
+endif	# netbsd
+
+###
 ### Linux
 ###
 
