$NetBSD: patch-aa,v 1.1.1.1 2002/09/11 18:37:09 jlam Exp $

--- Makefile.in.orig	Mon Apr 22 14:51:55 2002
+++ Makefile.in
@@ -1,7 +1,7 @@
 # Unix
 
 CC=@CC@
-CFLAGS=-g -Wall -ansi -pedantic -Wmissing-prototypes
+CFLAGS+=-Wall -ansi -pedantic -Wmissing-prototypes
 LDLIBS=
 OBJ=.@OBJEXT@
 EXE=@EXEEXT@
@@ -32,6 +32,11 @@ INSTALL = @INSTALL@
 
 IJS_COMMON_OBJ=ijs$(OBJ)
 
+.SUFFIXES: .lo
+
+.c.lo:
+	$(LIBTOOL) $(CC) $(CFLAGS) -c $<
+
 all:	libijs.a libijs$(SHARED_OBJ) ijs_client_example$(EXE) ijs_server_example$(EXE)
 
 LIB_OBJS=ijs$(OBJ) ijs_client$(OBJ) ijs_server$(OBJ) $(IJS_EXEC_SERVER)
@@ -47,6 +52,9 @@ libijs.a:	$(LIB_OBJS)
 libijs$(SHARED_OBJ):	$(LIB_OBJS)
 	$(CC) $(SHARED_LDFLAGS) $^ -o $@
 
+libijs.la: $(LIB_OBJS:.o=.lo)
+	$(LIBTOOL) $(CC) -o $@ $(LIB_OBJS:.o=.lo) -rpath $(libdir) -version-info $(IJS_VERSION_INFO)
+
 ijs_client_example$(EXE):	ijs_client_example$(OBJ) ijs_client$(OBJ) $(IJS_COMMON_OBJ) $(IJS_EXEC_SERVER)
 	$(CC) $(CFLAGS) $(FE)ijs_client_example$(EXE) ijs_client_example$(OBJ) ijs_client$(OBJ) $(IJS_COMMON_OBJ) $(IJS_EXEC_SERVER) $(LDLIBS)
 
@@ -59,11 +67,9 @@ common_clean:
 clean: common_clean
 	$(RM) *~ gmon.out core ijs_spec.log ijs_spec.tex ijs_spec.aux libijs.a libijs$(SHARED_OBJ) config.cache config.log config.status ijs-config
 
-install:	all
-	$(INSTALL) ijs_client_example$(EXE) -c $(bindir)/ijs_client_example$(EXE)
-	$(INSTALL) ijs-config -c $(bindir)/ijs-config
-	$(INSTALL) libijs.a $(libdir)/libijs.a
-	$(INSTALL) libijs$(SHARED_OBJ) $(libdir)/libijs$(SHARED_OBJ)
+install:
+	$(INSTALL) -c ijs-config $(bindir)/ijs-config
+	$(LIBTOOL) $(INSTALL) libijs.la $(libdir)/libijs.la
 	-mkdir $(pkgincludedir)
 	$(INSTALL) ijs.h $(pkgincludedir)/ijs.h
 	$(INSTALL) ijs_client.h $(pkgincludedir)/ijs_client.h
