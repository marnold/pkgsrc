$NetBSD: patch-ad,v 1.8.22.1 2005/08/19 11:37:05 salo Exp $

--- Imakefile.orig	2005-07-29 15:14:59.000000000 +0200
+++ Imakefile
@@ -6,13 +6,15 @@
 /* if, for whatever reason, you're unable to get the JPEG library to compile
  * on your machine, *COMMENT OUT* the following line
  */
-#define HaveJpeg
+/* #define HaveJpeg */
+#define UseInstalledJpeg
 
 
 /* if, for whatever reason, you're unable to get the TIFF library to compile
  * on your machine, *COMMENT OUT* the following line
  */
-#define HaveTiff
+/* #define HaveTiff */
+#define UseInstalledTiff
 
 
 /* if, for whatever reason, you're unable to get the PDS/VICAR support
@@ -124,16 +126,30 @@ MGCSFX = -DMGCSFXDIR=\"$(MGCSFXDIR)\"
 JPEG = -DDOJPEG
 JPEGDIR = jpeg
 LIBJPEG = $(JPEGDIR)/libjpeg.a
+DEPLIBJPEG = $(LIBJPEG)
 JPEGINCLUDE = -I$(JPEGDIR)
 #endif
 
+#ifdef UseInstalledJpeg
+JPEG = -DDOJPEG
+LIBJPEG = $(LDFLAGS) -L$(LOCALBASE)/lib -Wl,-R$(LOCALBASE)/lib -ljpeg
+JPEGINCLUDE = -I$(LOCALBASE)/include
+#endif
+
 #ifdef HaveTiff
 TIFF = -DDOTIFF
 TIFFDIR = tiff
 LIBTIFF = $(TIFFDIR)/libtiff.a
+DEPLIBTIFF = $(LIBTIFF)
 TIFFINCLUDE = -I$(TIFFDIR)
 #endif
 
+#ifdef UseInstalledTiff
+TIFF = -DDOTIFF
+LIBTIFF = -L$(LOCALBASE)/lib -ltiff -ljpeg -lz
+TIFFINCLUDE = -I$(LOCALBASE)/include
+#endif
+
 #ifdef HavePDS
 PDS = -DDOPDS
 #endif
@@ -149,8 +165,8 @@ SYS_LIBRARIES=        -lm
 #endif
 
 
-DEPLIBS = $(LIBJPEG) $(LIBTIFF)
-LOCAL_LIBRARIES = $(XLIB) $(DEPLIBS)
+DEPLIBS = $(DEPLIBJPEG) $(DEPLIBTIFF)
+LOCAL_LIBRARIES = $(XLIB) $(LIBJPEG) $(LIBTIFF)
 
 DEFINES= $(SCO) $(UNIX) $(NODIRENT) $(VPRINTF) $(TIMERS) \
 	$(HPUX7) $(JPEG) $(TIFF) $(PDS) $(DXWM) $(RAND) \
@@ -194,10 +210,10 @@ OBJS5=	xvpictoppm.o
 
 PROGRAMS= xv bggen vdcomp xcmap xvpictoppm
 
-all::
-	@echo ""
-	@echo "  Did you remember to 'make depend' first?"
-	@echo ""
+#all::
+#	@echo ""
+#	@echo "  Did you remember to 'make depend' first?"
+#	@echo ""
 
 
 #if defined(HaveJpeg) || defined(HaveTiff)
