$NetBSD: patch-aa,v 1.1.1.1 2004/06/27 21:33:24 abs Exp $

--- Makefile.orig	2004-04-29 22:37:25.000000000 +0100
+++ Makefile
@@ -1,6 +1,7 @@
 
 PROGRAM     = cambevao
-prefix      = /usr/pkg
+RCD_SCRIPT  = ${PROGRAM}.rc.d
+prefix     ?= /usr/pkg
 exec_prefix = ${prefix}
 bindir      = $(exec_prefix)/bin
 libdir      = $(exec_prefix)/lib
@@ -8,6 +9,7 @@ includedir  = $(prefix)/include
 manext      = 1
 mandir      = $(prefix)/man/man$(manext)
 
+SED     = sed
 RM      = rm -f
 INSTALL = /usr/bin/install -c -s -o root -g wheel -m 555
 CFLAGS  = -Wall -O2 -I$(includedir) -DPROGRAM=\"$(PROGRAM)\" -DMAX_CONN=3
@@ -24,11 +26,13 @@ OBJS = main.o font.o server.o log.o pref
 
 $(PROGRAM):	$(OBJS)
 	$(CC) $(LDFLAGS) $(OBJS) -o $(PROGRAM) $(LDLIBS)
-all:  $(PROGRAM)
+$(RCD_SCRIPT): template.rc.d
+	$(SED) -e 's:@PROGRAM@:${PROGRAM}:g' -e 's:@PREFIX@:${prefix}:g' < $> > $@
+all:  $(PROGRAM) $(RCD_SCRIPT)
 install: $(PROGRAM)
 	$(INSTALL) $(PROGRAM) $(bindir)
 clean:
-	$(RM) *.o $(PROGRAM) *.core
+	$(RM) *.o $(PROGRAM) $(RCD_SCRIPT) *.core
 
 distclean: clean
 	$(RM) *.jpg *.jpeg access.log
