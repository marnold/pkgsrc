$NetBSD: patch-ah,v 1.1.2.2 2009/08/28 22:15:55 tron Exp $

--- IlmImf/ImfZipCompressor.cpp.orig	2006-10-13 22:07:17.000000000 -0500
+++ IlmImf/ImfZipCompressor.cpp	2009-07-29 13:18:25.223038291 -0500
@@ -58,6 +58,9 @@ ZipCompressor::ZipCompressor
     _tmpBuffer (0),
     _outBuffer (0)
 {
+    if ((unsigned) maxScanLineSize > INT_MAX / (unsigned) numScanLines) {
+        throw Iex::InputExc ("Error: maxScanLineSize * numScanLines would overflow.");
+    }
     _tmpBuffer =
 	new char [maxScanLineSize * numScanLines];
 
