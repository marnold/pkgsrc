$NetBSD: patch-ab,v 1.1.1.1 2003/04/23 08:15:40 rh Exp $

--- player/swf_play.c.orig	2003-02-06 06:19:27.000000000 +1000
+++ player/swf_play.c
@@ -15,6 +15,8 @@
 #include <signal.h>
 #include <sys/wait.h>
 #include <sys/time.h>
+#include <sys/signal.h>
+#include <errno.h>
 #include <time.h>
 #include <string.h>
 
@@ -539,6 +541,19 @@ void fault_handler(int signum, siginfo_t
 	_exit(0);
 }
 
+#ifndef SA_SIGINFO
+void si_handler(int sig, int code, struct sigcontext *scp)
+{
+	siginfo_t si;
+
+	si.si_signo = sig;
+	si.si_errno = errno;
+	si.si_code = code;
+
+	fault_handler(sig, &si, scp);
+}
+#endif
+
 void fault_restore(void)
 {
 	struct sigaction action;
@@ -555,8 +570,13 @@ void fault_setup(void)
 	struct sigaction action;
 
 	memset(&action,0,sizeof(action));
+#ifdef SA_SIGINFO
 	action.sa_sigaction = fault_handler;
 	action.sa_flags = SA_SIGINFO;
+#else
+	action.sa_sigaction = (void (*)(int))si_handler;
+	action.sa_flags = 0;
+#endif
 
 	sigaction(SIGSEGV, &action, NULL);
 	sigaction(SIGQUIT, &action, NULL);
