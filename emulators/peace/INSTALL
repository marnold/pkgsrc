#!/bin/sh
#
# $NetBSD: INSTALL,v 1.1.1.1 2002/08/21 15:17:46 kent Exp $
# $PEACE: INSTALL,v 1.2 2002/08/21 03:54:08 kent Exp $

PKGNAME=$1
STAGE=$2

LN=/bin/ln
MKDIR=/bin/mkdir
MODLOAD=/sbin/modload
PECOFF=${PKG_PREFIX}/emul/pecoff
PEACEREG=/var/db/peace/reg
DLLPATH=${PECOFF}/usr/lib; export DLLPATH
PEACE_LOCALE=en_US; export PEACE_LOCALE

case ${STAGE} in
PRE-INSTALL)
	;;
POST-INSTALL)
	${MKDIR} /emul
	${LN} -sf ${PKG_PREFIX}/emul/pecoff /emul/pecoff
	${MODLOAD} /usr/lkm/compat_pecoff.o
	${MODLOAD} /usr/lkm/exec_pecoff.o
	${MKDIR} -p ${PEACEREG}/config
	${MKDIR} -p ${PEACEREG}/machine
	${MKDIR} -p ${PEACEREG}/root
	${PECOFF}/usr/bin/regcomserver ${PECOFF}/usr/lib/dsound.dll
	${PECOFF}/usr/bin/regcomserver ${PECOFF}/usr/lib/ddraw.dll
	;;
*)
	echo "Unexpected argument: ${STAGE}"
	exit 1
	;;
esac
exit 0
